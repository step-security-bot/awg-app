(self.webpackChunkawg_app=self.webpackChunkawg_app||[]).push([[216],{6216:(C,O,g)=>{"use strict";g.r(O),g.d(O,{EditionGraphModule:()=>We});var R=g(655),h=g(4650),I=g(5921);var xe,Pt=g(1818),Et=g.n(Pt);let ve=((xe=class{constructor(){this.clickedNodeRequest=new h.vpe}onGraphNodeClick(e){!e||this.clickedNodeRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}}).propDecorators={queryResult$:[{type:h.IIB}],defaultForceGraphHeight:[{type:h.IIB}],isFullscreen:[{type:h.IIB}],clickedNodeRequest:[{type:h.r_U}]},xe);ve=(0,R.gn)([(0,h.wA2)({selector:"awg-construct-results",template:'<ngb-accordion\n    #constructResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-construct-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-construct-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="queryResult.length > 0; else noResult">\n                    \x3c!-- Force graph visualization --\x3e\n                    <awg-force-graph\n                        class="full-width"\n                        [queryResultTriples]="queryResult"\n                        [height]="defaultForceGraphHeight"\n                        (clickedNodeRequest)="onGraphNodeClick($event)">\n                    </awg-force-graph>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n',changeDetection:h.n4l.OnPush,styles:[Et()]})],ve);var qt=g(8576),Ft=g.n(qt),et=g(7579),Ot=g(8372),kt=g(2722),V=g(2687),At=g(22);class Dt{constructor(){this.nodes=[],this.links=[],this.nodeTriples=[]}}class tt{constructor(e,t){this.source=e,this.target=t,this.predicate="",this.weight=1}}var Z,r,W,L;(r=Z||(Z={})).link="link",r.node="node";class Re{constructor(e,t){this.id=e,this.label=e,this.weight=1,this.type=t,this.owlClass=!1,this.instance=!1}}class Lt{constructor(e,t,n){this.nodeSubject=e,this.nodePredicate=t,this.nodeObject=n}}!function(r){r.TURTLE="TURTLE",r.SPARQL="SPARQL"}(W||(W={})),function(r){r.SHORT="short",r.LONG="long"}(L||(L={}));class D{constructor(e,t){this.prefixName=e,this.prefixIri=t}}const jt=[new D("awg","https://edition.anton-webern.ch/webern-onto#"),new D("dbo","http://dbpedia.org/ontology/"),new D("dbp","http://dbpedia.org/property/"),new D("dbpedia","http://dbpedia.org/resource/"),new D("dc","http://purl.org/dc/elements/1.1/"),new D("dcterms","http://purl.org/dc/terms/"),new D("foaf","http://xmlns.com/foaf/0.1/"),new D("mo","http://purl.org/ontology/mo/"),new D("owl","http://www.w3.org/2002/07/owl#"),new D("prov","http://www.w3.org/ns/prov#"),new D("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),new D("rdfs","http://www.w3.org/2000/01/rdf-schema#"),new D("skos","http://www.w3.org/2004/02/skos/core#"),new D("xsd","http://www.w3.org/2001/XMLSchema#")];let J=class{constructor(){this.defaultPrefixes=jt}transform(e,t){let n;switch(t){case L.SHORT:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixIri)&&(n=e.replace(s.prefixIri,s.prefixName+":"))});break;case L.LONG:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixName)&&(n=e.replace(s.prefixName+":",s.prefixIri))});break;default:const i=t;throw new Error(`The prefixForm must be ${L.SHORT} or ${L.LONG}, but was: ${i}.`)}return n||e}};J=(0,R.gn)([(0,h.E6H)({name:"prefix",pure:!1})],J);const te="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ne="http://www.w3.org/2001/XMLSchema#",Se="http://www.w3.org/2000/10/swap/",G={xsd:{decimal:`${ne}decimal`,boolean:`${ne}boolean`,double:`${ne}double`,integer:`${ne}integer`,string:`${ne}string`},rdf:{type:`${te}type`,nil:`${te}nil`,first:`${te}first`,rest:`${te}rest`,langString:`${te}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${Se}reify#forSome`,forAll:`${Se}reify#forAll`},log:{implies:`${Se}log#implies`}};var zt=g(6643),Mt=g.n(zt);const{xsd:ae}=G,Gt=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,nt={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},$t=/[\x00-\x20<>\\"\{\}\|\^\`]/,Qt={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},Bt=/$0^/;class Ht{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const t in this)!(t in Qt)&&this[t]instanceof RegExp&&(this[t]=Bt)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input,i=n.length;for(;;){let o,c;for(;o=this._newline.exec(n);)this._comments&&(c=this._comment.exec(o[0]))&&s("comment",c[1],"",this._line,o[0].length),n=n.substr(o[0].length,n.length),i=n.length,this._line++;if(!o&&(o=this._whitespace.exec(n))&&(n=n.substr(o[0].length,n.length)),this._endOfFile.test(n))return t&&(this._comments&&(c=this._comment.exec(n))&&s("comment",c[1],"",this._line,n.length),n=null,s("eof","","",this._line,0)),this._input=n;const l=this._line,x=n[0];let b="",p="",m="",_=null,f=0,d=!1;switch(x){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(f=1,b="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){d=!0;break}case"<":if(_=this._unescapedIri.exec(n))b="IRI",p=_[1];else if(_=this._iri.exec(n)){if(p=this._unescape(_[1]),null===p||$t.test(p))return a(this);b="IRI"}else n.length>1&&"<"===n[1]?(b="<<",f=2):this._n3Mode&&n.length>1&&"="===n[1]&&(b="inverse",f=2,p=">");break;case">":n.length>1&&">"===n[1]&&(b=">>",f=2);break;case"_":((_=this._blank.exec(n))||t&&(_=this._blank.exec(`${n} `)))&&(b="blank",m="_",p=_[1]);break;case'"':if(_=this._simpleQuotedString.exec(n))p=_[1];else if(({value:p,matchLength:f}=this._parseLiteral(n)),null===p)return a(this);(null!==_||0!==f)&&(b="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(_=this._simpleApostropheString.exec(n))p=_[1];else if(({value:p,matchLength:f}=this._parseLiteral(n)),null===p)return a(this);(null!==_||0!==f)&&(b="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(_=this._variable.exec(n))&&(b="var",p=_[0]);break;case"@":"literal"===this._previousMarker&&(_=this._langcode.exec(n))?(b="langcode",p=_[1]):(_=this._keyword.exec(n))&&(b=_[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){b=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(_=this._number.exec(n)||t&&(_=this._number.exec(`${n} `)))&&(b="literal",p=_[0],m="string"==typeof _[1]?ae.double:"string"==typeof _[2]?ae.decimal:ae.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(_=this._sparqlKeyword.exec(n))?b=_[0].toUpperCase():d=!0;break;case"f":case"t":(_=this._boolean.exec(n))?(b="literal",p=_[0],m=ae.boolean):d=!0;break;case"a":(_=this._shortPredicates.exec(n))?(b="abbreviation",p="a"):d=!0;break;case"=":this._n3Mode&&n.length>1&&(b="abbreviation",">"!==n[1]?(f=1,p="="):(f=2,p=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(f=1,b=x);break;default:d=!0}if(d&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(_=this._prefix.exec(n))?((_=this._prefixed.exec(n))||t&&(_=this._prefixed.exec(`${n} `)))&&(b="prefixed",m=_[1]||"",p=this._unescape(_[2])):(b="prefix",p=_[1]||"")),"^^"===this._previousMarker)switch(b){case"prefixed":b="type";break;case"IRI":b="typeIRI";break;default:b=""}if(!b)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?a(this):this._input=n;const y=f||_[0].length,v=s(b,p,m,l,y);this.previousToken=v,this._previousMarker=b,n=n.substr(y,n.length)}function s(o,c,l,x,b){const p=n?i-n.length:i,_={type:o,value:c,prefix:l,line:x,start:p,end:p+b};return e(null,_),_}function a(o){e(o._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(Gt,(i,s,a,o)=>{if("string"==typeof s)return String.fromCharCode(Number.parseInt(s,16));if("string"==typeof a){let c=Number.parseInt(a,16);return c<=65535?String.fromCharCode(Number.parseInt(a,16)):String.fromCharCode(55296+((c-=65536)>>10),56320+(1023&c))}return o in nt?nt[o]:(t=!0,"")});return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let i=Math.max(this._literalClosingPos,n);for(;(i=e.indexOf(t,i))>0;){let s=0;for(;"\\"===e[i-s-1];)s++;if(s%2==0){const a=e.substring(n,i),o=a.split(/\r\n|\r|\n/).length-1,c=i+n;if(1===n&&0!==o||3===n&&this._lineMode)break;return this._line+=o,{value:this._unescape(a),matchLength:c}}i++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const n=[];let i;if(this._tokenizeToEnd((s,a)=>s?i=s:n.push(a),!0),i)throw i;return n}Mt()(()=>this._tokenizeToEnd(t,!0))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",n=>{null!==this._input&&0!==n.length&&(this._pendingBuffer&&(n=Buffer.concat([this._pendingBuffer,n]),this._pendingBuffer=null),128&n[n.length-1]?this._pendingBuffer=n:(typeof this._input>"u"?this._input=this._readStartingBom("string"==typeof n?n:n.toString()):this._input+=n,this._tokenizeToEnd(t,!1)))}),e.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)}),e.on("error",t)}}const{rdf:Ut,xsd:X}=G;let re,Vt=0;const Te={namedNode:function en(r){return new it(r)},blankNode:function tn(r){return new Kt(r||"n3-"+Vt++)},variable:function rn(r){return new Wt(r)},literal:function nn(r,e){if("string"==typeof e)return new Y(`"${r}"@${e.toLowerCase()}`);let t=e?e.value:"";return""===t&&("boolean"==typeof r?t=X.boolean:"number"==typeof r&&(Number.isFinite(r)?t=Number.isInteger(r)?X.integer:X.double:(t=X.double,Number.isNaN(r)||(r=r>0?"INF":"-INF")))),""===t||t===X.string?new Y(`"${r}"`):new Y(`"${r}"^^${t}`)},defaultGraph:function sn(){return re},quad:st,triple:st},Xt=Te;class ${constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof $?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class it extends ${get termType(){return"NamedNode"}}class Y extends ${get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new it(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?X.string:Ut.langString}equals(e){return e instanceof Y?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class Kt extends ${constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Wt extends ${constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}re=new class Jt extends ${constructor(){return super(""),re||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};class Yt extends ${constructor(e,t,n,i){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=i||re}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function st(r,e,t,n){return new Yt(r,e,t,n)}let at=0;class Ie{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&ot(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),i=/trig/.test(t),s=/triple/.test(t),a=/quad/.test(t),o=this._n3Mode=/n3/.test(t),c=s||a;(this._supportsNamedGraphs=!(n||o))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||i||s||o),this._supportsRDFStar=""===t||/star|\*$/.test(t),c&&(this._resolveRelativeIRI=l=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new Ht({lineMode:c,n3:o}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){at=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,i,s){const a=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:i,object:s,graph:t,inverse:!!a&&this._inversePredicate,blankPrefix:a?this._prefixes._:"",quantified:a?this._quantified:null}),a&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const i=this._resolveIRI(e.value);if(null===i)return this._error("Invalid IRI",e);n=this._namedNode(i);break;case"type":case"prefixed":const s=this._prefixes[e.prefix];if(void 0===s)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._namedNode(s+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,i=this._readListItem;const s=this._subject,a=this._contextStack,o=a[a.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==a.length&&"list"===a[a.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blankNode()),null===s?null===o.predicate?o.subject=n:o.object=n:this._emit(s,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._literal(this._literalValue,n),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const i=this._subject,s=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==i){const a=this._predicate,o=this._object;s?this._emit(o,a,i,n):this._emit(i,a,o,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const i=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,i,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const i=this._blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=i):(t=this._object,this._object=i),this._emit(t,n,i,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let n,i;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=t):(i=this._object,this._object=t),this._emit(t,n,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,i){this._callback(null,this._quad(e,t,n,i||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=Pe}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",i=-1,s=-1,a=0,o="/";for(;i<t;){switch(o){case":":if(s<0&&"/"===e[++i]&&"/"===e[++i])for(;(s=i+1)<t&&"/"!==e[s];)i=s;break;case"?":case"#":i=t;break;case"/":if("."===e[i+1])switch(o=e[1+ ++i],o){case"/":n+=e.substring(a,i-1),a=i+1;break;case void 0:case"?":case"#":return n+e.substring(a,i)+e.substr(i+1);case".":if(o=e[1+ ++i],void 0===o||"/"===o||"?"===o||"#"===o){if(n+=e.substring(a,i-2),(a=n.lastIndexOf("/"))>=s&&(n=n.substr(0,a)),"/"!==o)return`${n}/${e.substr(i+1)}`;a=i+1}}}o=e[++i]}return n+e.substring(a)}parse(e,t,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${at++}_`,this._prefixCallback=n||Pe,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const i=[];let s;if(this._callback=(a,o)=>{a?s=a:o&&i.push(o)},this._lexer.tokenize(e).every(a=>this._readCallback=this._readCallback(a)),s)throw s;return i}this._callback=t,this._lexer.tokenize(e,(i,s)=>{null!==i?(this._callback(i),this._callback=Pe):this._readCallback&&(this._readCallback=this._readCallback(s))})}}function Pe(){}function ot(r,e){const t=e.namedNode;r._namedNode=t,r._blankNode=e.blankNode,r._literal=e.literal,r._variable=e.variable,r._quad=e.quad,r.DEFAULTGRAPH=e.defaultGraph(),r.RDF_FIRST=t(G.rdf.first),r.RDF_REST=t(G.rdf.rest),r.RDF_NIL=t(G.rdf.nil),r.N3_FORALL=t(G.r.forAll),r.N3_FORSOME=t(G.r.forSome),r.ABBREVIATIONS={a:t(G.rdf.type),"=":t(G.owl.sameAs),">":t(G.log.implies)},r.QUANTIFIERS_GRAPH=t("urn:n3:quantifiers")}var Ee;ot(Ie.prototype,Xt);let ie=((Ee=class{constructor(e){this.prefixPipe=e}parseTripleString(e){const t=new Ie,n=[];return new Promise((i,s)=>{t.parse(e,(a,o,c)=>{o?n.push(o):i({triples:n,namespaces:c}),a&&s(a)})})}limitTriples(e,t){return e?e.length>t?e.slice(0,t):e:[]}abbreviateTriples(e,t,n){return n||(n="text/turtle"),e.map(i=>{let s=i.subject.nominalValue,a=i.predicate.nominalValue,o=i.object.nominalValue;return"text/turtle"===n&&(null!=this._abbreviate(s,t)&&(s=this._abbreviate(s,t)),null!=this._abbreviate(a,t)&&(a=this._abbreviate(a,t)),null!=this._abbreviate(o,t)&&(o=this._abbreviate(o,t))),{subject:s,predicate:a,object:o}})}checkNamespacesInQuery(e,t){if(!e||!t)return;const n=this._extractNamespacesFromString(W.TURTLE,t),i=this._extractNamespacesFromString(W.SPARQL,e),s=this._extractQNamesFromSPARQLWhereClause(e),a=Object.keys(n),o=Object.keys(i);let c="";return a.forEach(l=>{-1===o.indexOf(l)&&(c+=`PREFIX ${l} ${n[l]}\n`)}),s.length>0&&s.forEach(l=>{if(-1===o.indexOf(l)){console.warn(`Prefix '${l}' not declared in SPARQL and/or Turtle header. Searching in default namespaces...`);const x=this.prefixPipe.transform(l,L.LONG);if(x!==l){const b=`PREFIX ${l} <${x}>\n`;c+=b,console.warn(`Added '${b}' to SPARQL prefixes from list of default namespaces.`)}else console.warn(`'${l}' is unknown. Please provide a declaration.`)}}),""!==c&&(e=c+e),e}doQuery(e,t,n,i){return i||(i="text/turtle"),this._createStore().then(s=>(this._store=s,this._loadTriplesInStore(s,n,i))).then(s=>this._executeQuery(this._store,t)).then(s=>{if("select"===e){const a=s;return this._prepareSelectResponse(a).data}if("construct"===e){const a=s;return this._getNamespaces(n).then(o=>this.abbreviateTriples(a.triples,o,i))}})}getQuerytype(e){let t=[{queryType:"select",index:-1},{queryType:"construct",index:-1},{queryType:"ask",index:-1},{queryType:"count",index:-1},{queryType:"describe",index:-1},{queryType:"insert",index:-1},{queryType:"delete",index:-1}],n=!1,i=1/0;if(t=t.map(o=>(o.index=e.toLowerCase().indexOf(o.queryType),-1!==o.index&&(n=!0,o.index<i&&(i=o.index)),o)),!n)return null;let a=t.find(o=>o.index===i).queryType;return("insert"===a||"delete"===a)&&(a="update"),a}_abbreviate(e,t){let n=e;return-1!==e.indexOf("http")&&Object.entries(t).forEach(([i,s])=>{-1!==e.indexOf(s)&&(n=e.replace(s,i+":"))}),n}_createStore(){return new Promise((e,t)=>{rdfstore.create((n,i)=>{n&&t(n),e(i)})})}_executeQuery(e,t){return new Promise((n,i)=>{e.execute(t,(s,a)=>{s&&(console.error("_executeQuery# got ERROR",s),i(s)),n(a)})})}_extractNamespacesFromString(e,t){const n=t.toLowerCase().replace(/\s/g," ").split(" ").filter(o=>""!==o);let i;switch(e){case W.TURTLE:i="@prefix".toLowerCase();break;case W.SPARQL:i="PREFIX".toLowerCase();break;default:throw new Error(`The type must be TURTLE or SPARQL, but was: ${e}.`)}const s=n.reduce((o,c,l)=>(c===i&&o.push(l),o),[]),a={};return s.forEach(o=>{const c=n[o+1];let l=n[o+2];"."===l.at(-1)&&(l=l.slice(0,-1)),a[c]=l}),a}_extractQNamesFromSPARQLWhereClause(e){let t,n=e.toLowerCase(),i=0;const s=[],a=/\b[a-zA-Z]{2,15}:/g,o="WHERE {".toLowerCase();for(n.includes(o)&&(i=n.indexOf(o)+o.length),n=n.slice(i);null!==(t=a.exec(n));)t.index===a.lastIndex&&a.lastIndex++,t.forEach(c=>{-1===s.indexOf(c)&&s.push(c)});return s}_getNamespaces(e){const t=new Ie;return new Promise((n,i)=>{t.parse(e,(s,a,o)=>{a||n(o),s&&i(s)})})}_loadTriplesInStore(e,t,n){return n||(n="text/turtle"),new Promise((i,s)=>{e.load(n,t,(a,o)=>{a&&(console.error("_loadTriplesInStore# got error",a),s(a)),i(o)})})}_mapKeys(e,t){const n=Object.keys(e).map(i=>({[t[i]||i]:e[i]}));return Object.assign({},...n)}_prepareSelectResponse(e){if(!e)return{status:404,data:void 0};if(null==e[0])return{status:400,data:"Query returned no results"};const t=Object.keys(e[0]),n=e,i={token:"type",type:"datatype",lang:"xml:lang"};for(const a in n)if(n.hasOwnProperty(a))for(const o in t)if(t.hasOwnProperty(o)&&(n[a][t[o]]=this._mapKeys(n[a][t[o]],i),n[a][t[o]].label="",n[a][t[o]].value)){n[a][t[o]].label=this.prefixPipe.transform(n[a][t[o]].value,L.SHORT);const c="http://www.w3.org/2001/XMLSchema#integer",l="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",x=n[a][t[o]].type,b=n[a][t[o]].datatype||"";"literal"===x&&(b===c||b===l)&&(n[a][t[o]].label=+n[a][t[o]].value)}return{status:200,data:{head:{vars:t},body:{bindings:n}}}}}).ctorParameters=()=>[{type:J}],Ee);ie=(0,R.gn)([(0,h.GSi)()],ie);var lt=g(903),Ne=g(711),ut=g(8840),ct=g(9374),Q=g(1466);const ce=r=>()=>r;function qe(r,{sourceEvent:e,subject:t,target:n,identifier:i,active:s,x:a,y:o,dx:c,dy:l,dispatch:x}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:x}})}function an(r){return!r.ctrlKey&&!r.button}function on(){return this.parentNode}function ln(r,e){return e??{x:r.x,y:r.y}}function un(){return navigator.maxTouchPoints||"ontouchstart"in this}qe.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};var hn=g(392);const ht=4294967296;function gn(r){return r.x}function _n(r){return r.y}var mn=Math.PI*(3-Math.sqrt(5));function yn(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),s=0,a=.6,o=new Map,c=(0,hn.HT)(b),l=(0,lt.Z)("tick","end"),x=function fn(){let r=1;return()=>(r=(1664525*r+1013904223)%ht)/ht}();function b(){p(),l.call("tick",e),t<n&&(c.stop(),l.call("end",e))}function p(f){var d,v,y=r.length;void 0===f&&(f=1);for(var S=0;S<f;++S)for(t+=(s-t)*i,o.forEach(function(u){u(t)}),d=0;d<y;++d)null==(v=r[d]).fx?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),null==v.fy?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return e}function m(){for(var y,f=0,d=r.length;f<d;++f){if((y=r[f]).index=f,null!=y.fx&&(y.x=y.fx),null!=y.fy&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=10*Math.sqrt(.5+f),S=f*mn;y.x=v*Math.cos(S),y.y=v*Math.sin(S)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function _(f){return f.initialize&&f.initialize(r,x),f}return null==r&&(r=[]),m(),e={tick:p,restart:function(){return c.restart(b),e},stop:function(){return c.stop(),e},nodes:function(f){return arguments.length?(r=f,m(),o.forEach(_),e):r},alpha:function(f){return arguments.length?(t=+f,e):t},alphaMin:function(f){return arguments.length?(n=+f,e):n},alphaDecay:function(f){return arguments.length?(i=+f,e):+i},alphaTarget:function(f){return arguments.length?(s=+f,e):s},velocityDecay:function(f){return arguments.length?(a=1-f,e):1-a},randomSource:function(f){return arguments.length?(x=f,o.forEach(_),e):x},force:function(f,d){return arguments.length>1?(null==d?o.delete(f):o.set(f,_(d)),e):o.get(f)},find:function(f,d,y){var u,w,T,E,P,v=0,S=r.length;for(null==y?y=1/0:y*=y,v=0;v<S;++v)(T=(u=f-(E=r[v]).x)*u+(w=d-E.y)*w)<y&&(P=E,y=T);return P},on:function(f,d){return arguments.length>1?(l.on(f,d),e):l.on(f)}}}function dt(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,b,p,m,_,f,d,y,v,s=r._root,a={data:n},o=r._x0,c=r._y0,l=r._x1,x=r._y1;if(!s)return r._root=a,r;for(;s.length;)if((f=e>=(b=(o+l)/2))?o=b:l=b,(d=t>=(p=(c+x)/2))?c=p:x=p,i=s,!(s=s[y=d<<1|f]))return i[y]=a,r;if(m=+r._x.call(null,s.data),_=+r._y.call(null,s.data),e===m&&t===_)return a.next=s,i?i[y]=a:r._root=a,r;do{i=i?i[y]=new Array(4):r._root=new Array(4),(f=e>=(b=(o+l)/2))?o=b:l=b,(d=t>=(p=(c+x)/2))?c=p:x=p}while((y=d<<1|f)==(v=(_>=p)<<1|m>=b));return i[v]=s,i[y]=a,r}function k(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function Fn(r){return r[0]}function kn(r){return r[1]}function Fe(r,e,t){var n=new Oe(e??Fn,t??kn,NaN,NaN,NaN,NaN);return null==r?n:n.addAll(r)}function Oe(r,e,t,n,i,s){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=s,this._root=void 0}function pt(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var A=Fe.prototype=Oe.prototype;function K(r){return function(){return r}}function H(r){return 1e-6*(r()-.5)}function jn(r){return r.x+r.vx}function zn(r){return r.y+r.vy}function Gn(r){return r.index}function ft(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}A.copy=function(){var t,n,r=new Oe(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return r;if(!e.length)return r._root=pt(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=pt(n));return r},A.add=function xn(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return dt(this.cover(e,t),e,t,r)},A.addAll=function vn(r){var e,t,i,s,n=r.length,a=new Array(n),o=new Array(n),c=1/0,l=1/0,x=-1/0,b=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(a[t]=i,o[t]=s,i<c&&(c=i),i>x&&(x=i),s<l&&(l=s),s>b&&(b=s));if(c>x||l>b)return this;for(this.cover(c,l).cover(x,b),t=0;t<n;++t)dt(this,a[t],o[t],r[t]);return this},A.cover=function wn(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,s=(n=Math.floor(e))+1;else{for(var c,l,a=i-t||1,o=this._root;t>r||r>=i||n>e||e>=s;)switch(l=(e<n)<<1|r<t,c=new Array(4),c[l]=o,o=c,a*=2,l){case 0:i=t+a,s=n+a;break;case 1:t=i-a,s=n+a;break;case 2:i=t+a,n=s-a;break;case 3:t=i-a,n=s-a}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=n,this._x1=i,this._y1=s,this},A.data=function Rn(){var r=[];return this.visit(function(e){if(!e.length)do{r.push(e.data)}while(e=e.next)}),r},A.extent=function Sn(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},A.find=function Tn(r,e,t){var n,a,o,c,l,_,f,i=this._x0,s=this._y0,x=this._x1,b=this._y1,p=[],m=this._root;for(m&&p.push(new k(m,i,s,x,b)),null==t?t=1/0:(i=r-t,s=e-t,x=r+t,b=e+t,t*=t);_=p.pop();)if(!(!(m=_.node)||(a=_.x0)>x||(o=_.y0)>b||(c=_.x1)<i||(l=_.y1)<s))if(m.length){var d=(a+c)/2,y=(o+l)/2;p.push(new k(m[3],d,y,c,l),new k(m[2],a,y,d,l),new k(m[1],d,o,c,y),new k(m[0],a,o,d,y)),(f=(e>=y)<<1|r>=d)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-f],p[p.length-1-f]=_)}else{var v=r-+this._x.call(null,m.data),S=e-+this._y.call(null,m.data),u=v*v+S*S;if(u<t){var w=Math.sqrt(t=u);i=r-w,s=e-w,x=r+w,b=e+w,n=m.data}}return n},A.remove=function Cn(r){if(isNaN(x=+this._x.call(null,r))||isNaN(b=+this._y.call(null,r)))return this;var e,n,i,s,x,b,p,m,_,f,d,y,t=this._root,a=this._x0,o=this._y0,c=this._x1,l=this._y1;if(!t)return this;if(t.length)for(;;){if((_=x>=(p=(a+c)/2))?a=p:c=p,(f=b>=(m=(o+l)/2))?o=m:l=m,e=t,!(t=t[d=f<<1|_]))return this;if(!t.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,y=d)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[d]=s:delete e[d],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=s,this)},A.removeAll=function In(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this},A.root=function Pn(){return this._root},A.size=function En(){var r=0;return this.visit(function(e){if(!e.length)do{++r}while(e=e.next)}),r},A.visit=function Nn(r){var t,i,s,a,o,c,e=[],n=this._root;for(n&&e.push(new k(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,s=t.x0,a=t.y0,o=t.x1,c=t.y1)&&n.length){var l=(s+o)/2,x=(a+c)/2;(i=n[3])&&e.push(new k(i,l,x,o,c)),(i=n[2])&&e.push(new k(i,s,x,l,c)),(i=n[1])&&e.push(new k(i,l,a,o,x)),(i=n[0])&&e.push(new k(i,s,a,l,x))}return this},A.visitAfter=function qn(r){var n,e=[],t=[];for(this._root&&e.push(new k(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var s,a=n.x0,o=n.y0,c=n.x1,l=n.y1,x=(a+c)/2,b=(o+l)/2;(s=i[0])&&e.push(new k(s,a,o,x,b)),(s=i[1])&&e.push(new k(s,x,o,c,b)),(s=i[2])&&e.push(new k(s,a,b,x,l)),(s=i[3])&&e.push(new k(s,x,b,c,l))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this},A.x=function On(r){return arguments.length?(this._x=r,this):this._x},A.y=function An(r){return arguments.length?(this._y=r,this):this._y};var Qn=g(1280),ke=g(2232);var he,Hn=g(4967);const de_LINK_DISTANCE=10,de_COLLISION_STRENGTH=1,de_COLLISION_RADIUS=30,de_CHARGE_STRENGTH=-10;let Ae=(he=class{constructor(e,t){this.graphVisualizerService=e,this.prefixPipe=t,this.clickedNodeRequest=new h.vpe,this.faCompressArrowsAlt=V.udn,this.limitValues=[5,10,25,50,100,250,500,1e3],this.limit=50,this.sliderConfig=new At.w(1,.1,3,.01,1),this._resize$=new et.x,this._destroyed$=new et.x}onResize(){!this._graphContainer||!this.queryResultTriples||(this._divWidth=this._getContainerDimensions(this._graphContainer).width,this._divHeight=this._getContainerDimensions(this._graphContainer).height,this._resize$.next(!0))}ngOnInit(){this._resize$.pipe((0,Ot.b)(150),(0,kt.R)(this._destroyed$)).subscribe(e=>{this._redraw()}),this._redraw()}ngOnChanges(e){e.queryResultTriples&&e.queryResultTriples.currentValue&&!e.queryResultTriples.isFirstChange()&&(this.queryResultTriples=e.queryResultTriples.currentValue,this._redraw())}onLimitValueChange(e){this.limit=e,this._redraw()}onReCenter(){!this._svg||!this._divWidth||!this._divHeight||(this.onZoomChange(this.sliderConfig.initial),this._zoomBehaviour.translateTo(this._svg,this._divWidth/2,this._divHeight/2))}onZoomChange(e){this.sliderConfig.value=e,this._reScaleZoom()}log(e,t){const n=t&&JSON.parse(JSON.stringify(t));console.info(e,n)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_redraw(){this.queryResultTriples&&(this._cleanSVG(),this._createSVG(),this._attachData(),this._reScaleZoom())}_cleanSVG(){(function Bn(r){return"string"==typeof r?new ke.Y1([document.querySelectorAll(r)],[document.documentElement]):new ke.Y1([(0,Qn.Z)(r)],ke.Jz)})("svg.force-graph > *").remove()}_createSVG(){if(!this._graphContainer)return;let e,t;e=this._divWidth?this._divWidth:this._getContainerDimensions(this._graphContainer).width?this._getContainerDimensions(this._graphContainer).width:400,t=this._divHeight?this._divHeight:this._getContainerDimensions(this._graphContainer).height?this._getContainerDimensions(this._graphContainer).height:500,this._divWidth=e,this._divHeight=t-45,this._svg||(this._svg=Ne.Z(this._graphContainer.nativeElement).append("svg").attr("class","force-graph")),this._svg.attr("width",this._divWidth).attr("height",this._divHeight),this._zoomGroup=this._svg.append("g").attr("class","zoom-container")}_attachData(){const e=this.graphVisualizerService.limitTriples(this.queryResultTriples,this.limit);"string"==typeof e?this.graphVisualizerService.parseTripleString(e).then(t=>{const n=this.graphVisualizerService.abbreviateTriples(t.triples,t.namespaces);this._simulationData=this._triplesToD3GraphData(n),this._setupForceSimulation(),this._updateSVG()}):(this._simulationData=this._triplesToD3GraphData(e),this._setupForceSimulation(),this._updateSVG())}_setupForceSimulation(){this._forceSimulation=yn();const e=function Dn(){var r,e,t,n,s,i=K(-30),a=1,o=1/0,c=.81;function l(m){var _,f=r.length,d=Fe(r,gn,_n).visitAfter(b);for(n=m,_=0;_<f;++_)e=r[_],d.visit(p)}function x(){if(r){var m,f,_=r.length;for(s=new Array(_),m=0;m<_;++m)f=r[m],s[f.index]=+i(f,m,r)}}function b(m){var f,d,v,S,u,_=0,y=0;if(m.length){for(v=S=u=0;u<4;++u)(f=m[u])&&(d=Math.abs(f.value))&&(_+=f.value,y+=d,v+=d*f.x,S+=d*f.y);m.x=v/y,m.y=S/y}else{(f=m).x=f.data.x,f.y=f.data.y;do{_+=s[f.data.index]}while(f=f.next)}m.value=_}function p(m,_,f,d){if(!m.value)return!0;var y=m.x-e.x,v=m.y-e.y,S=d-_,u=y*y+v*v;if(S*S/c<u)return u<o&&(0===y&&(u+=(y=H(t))*y),0===v&&(u+=(v=H(t))*v),u<a&&(u=Math.sqrt(a*u)),e.vx+=y*m.value*n/u,e.vy+=v*m.value*n/u),!0;if(!(m.length||u>=o)){(m.data!==e||m.next)&&(0===y&&(u+=(y=H(t))*y),0===v&&(u+=(v=H(t))*v),u<a&&(u=Math.sqrt(a*u)));do{m.data!==e&&(S=s[m.data.index]*n/u,e.vx+=y*S,e.vy+=v*S)}while(m=m.next)}}return l.initialize=function(m,_){r=m,t=_,x()},l.strength=function(m){return arguments.length?(i="function"==typeof m?m:K(+m),x(),l):i},l.distanceMin=function(m){return arguments.length?(a=m*m,l):Math.sqrt(a)},l.distanceMax=function(m){return arguments.length?(o=m*m,l):Math.sqrt(o)},l.theta=function(m){return arguments.length?(c=m*m,l):Math.sqrt(c)},l}().strength(s=>this._nodeRadius(s)*de_CHARGE_STRENGTH),t=function Ln(r,e){var t,n=1;function i(){var s,o,a=t.length,c=0,l=0;for(s=0;s<a;++s)c+=(o=t[s]).x,l+=o.y;for(c=(c/a-r)*n,l=(l/a-e)*n,s=0;s<a;++s)(o=t[s]).x-=c,o.y-=l}return null==r&&(r=0),null==e&&(e=0),i.initialize=function(s){t=s},i.x=function(s){return arguments.length?(r=+s,i):r},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(n=+s,i):n},i}(this._divWidth/2,this._divHeight/2),n=function Mn(r){var e,t,n,i=1,s=1;function a(){for(var l,b,p,m,_,f,d,x=e.length,y=0;y<s;++y)for(b=Fe(e,jn,zn).visitAfter(o),l=0;l<x;++l)p=e[l],f=t[p.index],d=f*f,m=p.x+p.vx,_=p.y+p.vy,b.visit(v);function v(S,u,w,T,E){var P=S.data,q=S.r,N=f+q;if(!P)return u>m+N||T<m-N||w>_+N||E<_-N;if(P.index>p.index){var F=m-P.x-P.vx,M=_-P.y-P.vy,z=F*F+M*M;z<N*N&&(0===F&&(z+=(F=H(n))*F),0===M&&(z+=(M=H(n))*M),z=(N-(z=Math.sqrt(z)))/z*i,p.vx+=(F*=z)*(N=(q*=q)/(d+q)),p.vy+=(M*=z)*N,P.vx-=F*(N=1-N),P.vy-=M*N)}}}function o(l){if(l.data)return l.r=t[l.data.index];for(var x=l.r=0;x<4;++x)l[x]&&l[x].r>l.r&&(l.r=l[x].r)}function c(){if(e){var l,b,x=e.length;for(t=new Array(x),l=0;l<x;++l)b=e[l],t[b.index]=+r(b,l,e)}}return"function"!=typeof r&&(r=K(null==r?1:+r)),a.initialize=function(l,x){e=l,n=x,c()},a.iterations=function(l){return arguments.length?(s=+l,a):s},a.strength=function(l){return arguments.length?(i=+l,a):i},a.radius=function(l){return arguments.length?(r="function"==typeof l?l:K(+l),c(),a):r},a}().strength(de_COLLISION_STRENGTH).radius(de_COLLISION_RADIUS).iterations(2),i=function $n(r){var n,s,a,o,c,l,e=Gn,t=function b(d){return 1/Math.min(o[d.source.index],o[d.target.index])},i=K(30),x=1;function p(d){for(var y=0,v=r.length;y<x;++y)for(var u,w,T,E,P,q,N,S=0;S<v;++S)w=(u=r[S]).source,E=(T=u.target).x+T.vx-w.x-w.vx||H(l),P=T.y+T.vy-w.y-w.vy||H(l),E*=q=((q=Math.sqrt(E*E+P*P))-s[S])/q*d*n[S],P*=q,T.vx-=E*(N=c[S]),T.vy-=P*N,w.vx+=E*(N=1-N),w.vy+=P*N}function m(){if(a){var d,u,y=a.length,v=r.length,S=new Map(a.map((w,T)=>[e(w,T,a),w]));for(d=0,o=new Array(y);d<v;++d)(u=r[d]).index=d,"object"!=typeof u.source&&(u.source=ft(S,u.source)),"object"!=typeof u.target&&(u.target=ft(S,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(d=0,c=new Array(v);d<v;++d)u=r[d],c[d]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);n=new Array(v),_(),s=new Array(v),f()}}function _(){if(a)for(var d=0,y=r.length;d<y;++d)n[d]=+t(r[d],d,r)}function f(){if(a)for(var d=0,y=r.length;d<y;++d)s[d]=+i(r[d],d,r)}return null==r&&(r=[]),p.initialize=function(d,y){a=d,l=y,m()},p.links=function(d){return arguments.length?(r=d,m(),p):r},p.id=function(d){return arguments.length?(e=d,p):e},p.iterations=function(d){return arguments.length?(x=+d,p):x},p.strength=function(d){return arguments.length?(t="function"==typeof d?d:K(+d),_(),p):t},p.distance=function(d){return arguments.length?(i="function"==typeof d?d:K(+d),f(),p):i},p}().links(this._simulationData.links).id(s=>s.predicate).distance(de_LINK_DISTANCE);this._forceSimulation.force("charge_force",e).force("center_force",t).force("collide_force",n),this._forceSimulation.nodes(this._simulationData.nodes),this._forceSimulation.force("links",i),this._forceSimulation.alpha(1).restart()}_updateSVG(){if(!this._svg)return;this._zoomGroup.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",30).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:polyline").attr("points","0,-5 10,0 0,5");const e=this._zoomGroup.append("g").attr("class","links").selectAll(".link").data(this._simulationData.nodeTriples).enter().append("path").attr("marker-end","url(#end)").attr("class","link"),t=this._zoomGroup.append("g").attr("class","link-texts").selectAll(".link-text").data(this._simulationData.nodeTriples).enter().append("text").attr("class","link-text").text(s=>s.nodePredicate.label),n=this._zoomGroup.append("g").attr("class","node-texts").selectAll(".node-text").data(this._filterNodesByType(this._simulationData.nodes,Z.node)).enter().append("text").attr("class","node-text").text(s=>s.label),i=this._zoomGroup.append("g").attr("class","nodes").selectAll(".node").data(this._filterNodesByType(this._simulationData.nodes,Z.node)).enter().append("circle").attr("class",s=>s.owlClass?"class":-1!==s.label.indexOf("_:")?"blank":s.instance||-1!==s.label.indexOf("inst:")?"instance":"node").attr("id",s=>s.label).attr("r",s=>-1!==s.label.indexOf("_:")?8:s.instance||-1!==s.label.indexOf("inst:")?11:s.owlClass||-1!==s.label.indexOf("inst:")?10:9).on("click",(s,a)=>{this._clickedOnNode(s,a)});this._forceSimulation.on("tick",()=>{this._updateNodePositions(i),this._updateNodeTextPositions(n),this._updateLinkPositions(e),this._updateLinkTextPositions(t)}),this._dragHandler(i,this._forceSimulation),this._zoomHandler(this._zoomGroup,this._svg)}_reScaleZoom(){!this._svg||!this.sliderConfig.value||this._zoomBehaviour.scaleTo(this._svg,this.sliderConfig.value)}_checkForRdfType(e){return"a"===e.label||"rdf:type"===e.label||e.label===this.prefixPipe.transform("rdf:type",L.LONG)}_clickedOnNode(e,t){e.defaultPrevented||this.clickedNodeRequest.emit(t)}_dragHandler(e,t){const a=function cn(){var o,c,l,x,r=an,e=on,t=ln,n=un,i={},s=(0,lt.Z)("start","drag","end"),a=0,b=0;function p(u){u.on("mousedown.drag",m).filter(n).on("touchstart.drag",d).on("touchmove.drag",y,Q.Q7).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(u,w){if(!x&&r.call(this,u,w)){var T=S(this,e.call(this,u,w),u,w,"mouse");!T||((0,Ne.Z)(u.view).on("mousemove.drag",_,Q.Dd).on("mouseup.drag",f,Q.Dd),(0,ct.Z)(u.view),(0,Q.rG)(u),l=!1,o=u.clientX,c=u.clientY,T("start",u))}}function _(u){if((0,Q.ZP)(u),!l){var w=u.clientX-o,T=u.clientY-c;l=w*w+T*T>b}i.mouse("drag",u)}function f(u){(0,Ne.Z)(u.view).on("mousemove.drag mouseup.drag",null),(0,ct.D)(u.view,l),(0,Q.ZP)(u),i.mouse("end",u)}function d(u,w){if(r.call(this,u,w)){var q,N,T=u.changedTouches,E=e.call(this,u,w),P=T.length;for(q=0;q<P;++q)(N=S(this,E,u,w,T[q].identifier,T[q]))&&((0,Q.rG)(u),N("start",u,T[q]))}}function y(u){var E,P,w=u.changedTouches,T=w.length;for(E=0;E<T;++E)(P=i[w[E].identifier])&&((0,Q.ZP)(u),P("drag",u,w[E]))}function v(u){var E,P,w=u.changedTouches,T=w.length;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),E=0;E<T;++E)(P=i[w[E].identifier])&&((0,Q.rG)(u),P("end",u,w[E]))}function S(u,w,T,E,P,q){var M,z,ye,N=s.copy(),F=(0,ut.Z)(q||T,w);if(null!=(ye=t.call(u,new qe("beforestart",{sourceEvent:T,target:p,identifier:P,active:a,x:F[0],y:F[1],dx:0,dy:0,dispatch:N}),E)))return M=ye.x-F[0]||0,z=ye.y-F[1]||0,function Or(Je,Tt,kr){var Ye,Ct=F;switch(Je){case"start":i[P]=Or,Ye=a++;break;case"end":delete i[P],--a;case"drag":F=(0,ut.Z)(kr||Tt,w),Ye=a}N.call(Je,u,new qe(Je,{sourceEvent:Tt,subject:ye,target:p,identifier:P,active:Ye,x:F[0]+M,y:F[1]+z,dx:F[0]-Ct[0],dy:F[1]-Ct[1],dispatch:N}),E)}}return p.filter=function(u){return arguments.length?(r="function"==typeof u?u:ce(!!u),p):r},p.container=function(u){return arguments.length?(e="function"==typeof u?u:ce(u),p):e},p.subject=function(u){return arguments.length?(t="function"==typeof u?u:ce(u),p):t},p.touchable=function(u){return arguments.length?(n="function"==typeof u?u:ce(!!u),p):n},p.on=function(){var u=s.on.apply(s,arguments);return u===s?p:u},p.clickDistance=function(u){return arguments.length?(b=(u=+u)*u,p):Math.sqrt(b)},p}().on("start",(o,c)=>{o.sourceEvent.stopPropagation(),o.active||t.alphaTarget(.3).restart(),c.fx=c.x,c.fy=c.y}).on("drag",(o,c)=>{c.fx=o.x,c.fy=o.y}).on("end",(o,c)=>{o.active||t.alphaTarget(0),c.fx=null,c.fy=null});e.call(a)}_zoomHandler(e,t){this._zoomBehaviour=Hn.sP().scaleExtent([this.sliderConfig.min,this.sliderConfig.max]).on("zoom",i=>{const s=i.transform,a=this._roundToNearestScaleStep(s.k);e.attr("transform",s),this._sliderInput.nativeElement.value=a,this._sliderInputLabel.nativeElement.innerText=a+"x",this.sliderConfig.value=a}),t.call(this._zoomBehaviour)}_filterNodesById(e,t){return e.filter(n=>n.id===t)[0]}_filterNodesByType(e,t){return e.filter(n=>n.type===t)}_getContainerDimensions(e){return e&&e.nativeElement?{width:e.nativeElement.clientWidth,height:e.nativeElement.clientHeight}:null}_nodeRadius(e){if(!e)return null;let t=8;return-1!==e.label.indexOf("_:")?t-=1:e.instance||-1!==e.label.indexOf("inst:")?t+=2:(e.owlClass||-1!==e.label.indexOf("inst:"))&&(t+=1),t}_roundToNearestScaleStep(e){const t=this.sliderConfig.stepSize;return((s,a)=>Number(Math.round(Number(s+"e"+a))+"e-"+a))(e,(s=t,Math.floor(s)===s?0:s.toString().split(".")[1].length||0));var s}_triplesToD3GraphData(e){if(!e)return;const t=new Dt;return e.forEach(n=>{const i=this.prefixPipe.transform(n.subject,L.SHORT),s=this.prefixPipe.transform(n.predicate,L.SHORT);let a=this.prefixPipe.transform(n.object,L.SHORT);isNaN(a)||(a=Number(a)%1==0?String(Number(a)):String(Number(a).toFixed(2)));const o=new Re(s,Z.link);t.nodes.push(o);let c=this._filterNodesById(t.nodes,i);null==c&&(c=new Re(i,Z.node),t.nodes.push(c));let l=this._filterNodesById(t.nodes,a);null==l&&(l=new Re(a,Z.node),t.nodes.push(l)),!1===c.instance&&(c.instance=this._checkForRdfType(o)),!1===l.owlClass&&(l.owlClass=this._checkForRdfType(o)),t.links.push(new tt(c,o)),t.links.push(new tt(o,l)),t.nodeTriples.push(new Lt(c,o,l))}),t}_updateNodePositions(e){e.attr("cx",t=>t.x).attr("cy",t=>t.y)}_updateNodeTextPositions(e){e.attr("x",t=>t.x+12).attr("y",t=>t.y+3)}_updateLinkPositions(e){e.attr("d",t=>{const n=t.nodeSubject.x,i=t.nodeSubject.y;let s=t.nodeObject.x,a=t.nodeObject.y;let c=0,l=0,x=0,b=0;return n===s&&i===a&&(x=-45,b=1,c=30,l=20,s+=1,a+=1),"M"+n+","+i+"A"+c+","+l+" "+x+","+b+",1 "+s+","+a})}_updateLinkTextPositions(e){e.attr("x",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?20+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3:10+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3).attr("y",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3-40:4+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3)}},he.ctorParameters=()=>[{type:ie},{type:J}],he.propDecorators={queryResultTriples:[{type:h.IIB}],height:[{type:h.IIB}],clickedNodeRequest:[{type:h.r_U}],_graphContainer:[{type:h.i9L,args:["graphContainer",{static:!0}]}],_sliderInput:[{type:h.i9L,args:["sliderInput",{static:!0}]}],_sliderInputLabel:[{type:h.i9L,args:["sliderInputLabel",{static:!0}]}],onResize:[{type:h.L6J,args:["window:resize"]}]},he);Ae=(0,R.gn)([(0,h.wA2)({selector:"awg-force-graph",template:'<div\n    #graphContainer\n    id="awg-force-graph-container"\n    class="awg-force-graph-panel-container"\n    [ngStyle]="{ \'height.px\': height }">\n    <div class="awg-force-graph-icon-bar">\n        \x3c!-- Slider --\x3e\n        <div class="input-group input-group-sm awg-force-graph-zoom-slider-container float-start mb-3">\n            <span #sliderInputLabel class="input-group-text" id="slider-label">{{ sliderConfig.value }}x</span>\n            <input\n                type="range"\n                #sliderInput\n                class="awg-force-graph-zoom-slider"\n                id="awg-force-graph-zoom-slider"\n                name="zoomSlider"\n                aria-label="Zoom slider"\n                aria-describedby="slider-label"\n                [min]="sliderConfig.min"\n                [max]="sliderConfig.max"\n                [step]="sliderConfig.stepSize"\n                [(ngModel)]="sliderConfig.value"\n                (ngModelChange)="onZoomChange($event)" />\n            <button class="btn btn-sm btn-outline-info" type="submit" title="Reset" (click)="onReCenter()">\n                <fa-icon [icon]="faCompressArrowsAlt"></fa-icon>\n            </button>\n        </div>\n\n        \x3c!-- Limit --\x3e\n        <div class="btn-group awg-force-graph-node-limit-container float-end my-auto" *ngIf="queryResultTriples">\n            <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                <span *ngIf="limit < queryResultTriples.length">{{ limit }} von </span\n                >{{ queryResultTriples.length }} Triples\n            </button>\n            <div\n                class="btn-group"\n                ngbDropdown\n                container="body"\n                role="group"\n                aria-label="Button group with nested dropdown for node limit">\n                <button\n                    class="btn btn-sm btn-info dropdown-toggle-split"\n                    ngbDropdownToggle\n                    [disabled]="queryResultTriples.length === 0"></button>\n                <div class="dropdown-menu" ngbDropdownMenu>\n                    <ng-container *ngFor="let limitValue of limitValues">\n                        <button\n                            *ngIf="queryResultTriples.length > limitValue"\n                            class="dropdown-item"\n                            (click)="onLimitValueChange(limitValue)">\n                            <span>{{ limitValue }}</span>\n                        </button>\n                    </ng-container>\n                    <button class="dropdown-item" (click)="onLimitValueChange(queryResultTriples.length)">\n                        <span>Kein Limit</span>\n                    </button>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- <span *ngIf="message" class="message">{{message}}</span> --\x3e\n    </div>\n</div>\n',styles:[Ft()]})],Ae);var De,Vn=g(6627),Zn=g.n(Vn);let Le=((De=class{constructor(){this.clickedTableRequest=new h.vpe}isNotEmpty(e){if(e.head&&e.body)return e.head.vars.length>0&&e.body.bindings.length>0}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}}).propDecorators={queryResult$:[{type:h.IIB}],queryTime:[{type:h.IIB}],isFullscreen:[{type:h.IIB}],clickedTableRequest:[{type:h.r_U}]},De);Le=(0,R.gn)([(0,h.wA2)({selector:"awg-select-results",template:'<ngb-accordion\n    #selectResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-select-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-select-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="isNotEmpty(queryResult); else noResult">\n                    \x3c!-- SPARQL table visualization --\x3e\n                    <awg-sparql-table\n                        [queryResult]="queryResult"\n                        [queryTime]="queryTime"\n                        (clickedTableRequest)="onTableNodeClick($event)">\n                    </awg-sparql-table>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n',changeDetection:h.n4l.OnPush,styles:[Zn()]})],Le);var B,Kn=g(9063),Wn=g.n(Kn);function gt(r){return new RegExp("^(?:"+r.join("|")+")$","i")}var Jn=gt(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),Yn=gt(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load","into"]),er=/[*+\-<>=&|\^\/!\?]/;function _t(r,e){var t=r.next();if(B=null,"$"==t||"?"==t)return"?"==t&&r.match(/\s/,!1)?"operator":(r.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variableName.local");if("<"==t&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==t||"'"==t)return e.tokenize=function tr(r){return function(e,t){for(var i,n=!1;null!=(i=e.next());){if(i==r&&!n){t.tokenize=_t;break}n=!n&&"\\"==i}return"string"}}(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return B=t,"bracket";if("#"==t)return r.skipToEnd(),"comment";if(er.test(t))return"operator";if(":"==t)return bt(r),"atom";if("@"==t)return r.eatWhile(/[a-z\d\-]/i),"meta";if(r.eatWhile(/[_\w\d]/),r.eat(":"))return bt(r),"atom";var n=r.current();return Jn.test(n)?"builtin":Yn.test(n)?"keyword":"variable"}function bt(r){r.match(/(\.(?=[\w_\-\\%])|[:\w_-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-f\d][a-f\d])+/i)}function pe(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function fe(r){r.indent=r.context.indent,r.context=r.context.prev}const nr={name:"sparql",startState:function(){return{tokenize:_t,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&null==e.context.align&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if("comment"!=t&&e.context&&null==e.context.align&&"pattern"!=e.context.type&&(e.context.align=!0),"("==B)pe(e,")",r.column());else if("["==B)pe(e,"]",r.column());else if("{"==B)pe(e,"}",r.column());else if(/[\]\}\)]/.test(B)){for(;e.context&&"pattern"==e.context.type;)fe(e);e.context&&B==e.context.type&&(fe(e),"}"==B&&e.context&&"pattern"==e.context.type&&fe(e))}else"."==B&&e.context&&"pattern"==e.context.type?fe(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?pe(e,"pattern",r.column()):"pattern"==e.context.type&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var n=e&&e.charAt(0),i=r.context;if(/[\]\}]/.test(n))for(;i&&"pattern"==i.type;)i=i.prev;var s=i&&n==i.type;return i?"pattern"==i.type?i.col:i.align?i.col+(s?0:1):i.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var je,ee=g(6139),j=g(2838);let ze=((je=class{constructor(){this.errorMessageRequest=new h.vpe,this.performQueryRequest=new h.vpe,this.resetQueryRequest=new h.vpe,this.updateQueryStringRequest=new h.vpe,this.cmSparqlMode=nr,this.faDiagramProject=V.Bkj,this.faTable=V.B3e,this.selectedViewType=j.d.GRAPH,this.viewHandles=[new j.j("Graph view",j.d.GRAPH,V.Bkj),new j.j("Table view",j.d.TABLE,V.B3e)]}ngOnInit(){this.setViewType()}ngOnChanges(e){e.query&&!e.query.isFirstChange()&&this.setViewType()}setViewType(){this.query.queryType&&"construct"===this.query.queryType&&(this.selectedViewType=j.d.GRAPH),this.query.queryType&&"select"===this.query.queryType&&(this.selectedViewType=j.d.TABLE)}onViewChange(e){this.switchQueryType(e),this.onEditorInputChange(this.query.queryString),this.performQuery()}switchQueryType(e){switch(e){case j.d.TABLE:"construct"===this.query.queryType&&this.query.queryString.includes("CONSTRUCT")&&(this.query.queryString=this.query.queryString.replace("CONSTRUCT","SELECT *"),this.query.queryType="select");break;case j.d.GRAPH:"select"===this.query.queryType&&this.query.queryString.includes("SELECT")&&(this.query.queryString=this.query.queryString.replace(/SELECT.*\n/,"CONSTRUCT\n"),this.query.queryType="construct");break;case j.d.GRID:break;default:const t=e;throw new Error(`The view must be ${j.d.GRAPH} or ${j.d.TABLE}, but was: ${t}.`)}}isExampleQueriesEnabled(){return!!(this.query&&this.query.queryType&&this.query.queryLabel&&this.query.queryString&&this.queryList)}onEditorInputChange(e){this.updateQueryStringRequest.emit(e)}onQueryListChange(e){!e||!this.queryList||(e=this.queryList.find(t=>e.queryLabel===t.queryLabel&&e.queryType===t.queryType)||this.queryList[0],this.resetQuery(e))}performQuery(){this.query.queryString?this.performQueryRequest.emit():this.errorMessageRequest.emit(new ee.Kb("Empty query","Please enter a SPARQL query."))}resetQuery(e){!e||this.resetQueryRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-sparql-query":""}}).propDecorators={sparqlAcc:[{type:h.i9L,args:["sparqlAcc"]}],queryList:[{type:h.IIB}],query:[{type:h.IIB}],isFullscreen:[{type:h.IIB}],errorMessageRequest:[{type:h.r_U}],performQueryRequest:[{type:h.r_U}],resetQueryRequest:[{type:h.r_U}],updateQueryStringRequest:[{type:h.r_U}]},je);ze=(0,R.gn)([(0,h.wA2)({selector:"awg-sparql-editor",template:'<ngb-accordion\n    #sparqlAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-sparql-query">\n        <ng-template ngbPanelHeader>\n            <div class="accordion-button awg-accordion-button-custom-header justify-content-between">\n                <button ngbPanelToggle class="p-0 btn btn-link text-start">SPARQL</button>\n\n                \x3c!-- View Handle --\x3e\n                <awg-view-handle-button-group\n                    [viewHandles]="viewHandles"\n                    [selectedViewType]="selectedViewType"\n                    (viewChangeRequest)="onViewChange($event)"></awg-view-handle-button-group>\n\n                \x3c!-- Example Query Handle --\x3e\n                <div\n                    class="p-0 btn-group awg-example-query-btn-group"\n                    *ngIf="isExampleQueriesEnabled()"\n                    style="padding: -3rem">\n                    <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                        Beispielabfragen\n                    </button>\n                    <div\n                        class="btn-group"\n                        ngbDropdown\n                        container="body"\n                        placement="bottom-right"\n                        role="group"\n                        aria-label="Button group with nested dropdown for sample queries">\n                        <button class="btn btn-sm btn-info" ngbDropdownToggle></button>\n                        <div ngbDropdownMenu>\n                            <h6 class="dropdown-header">Graph-Ansicht (CONSTRUCT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'construct\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                            <div class="dropdown-divider"></div>\n                            <h6 class="dropdown-header">Tabellen-Ansicht (SELECT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'select\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <awg-codemirror\n                ngDefaultControl\n                [mode]="cmSparqlMode"\n                [(content)]="query.queryString"\n                (contentChange)="onEditorInputChange($event)"></awg-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="mt-2 awg-graph-visualizer-sparql-query-handle-buttons">\n                <button class="btn btn-outline-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-warning" (click)="resetQuery(query)">Reset</button>\n                <button class="btn btn-danger" (click)="onEditorInputChange(\'\')">Clear</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n',changeDetection:h.n4l.OnPush,styles:[Wn()]})],ze);var Me,ir=g(322),sr=g.n(ir),ar=g(67);let Ge=((Me=class{constructor(e){this.coreService=e}ngOnInit(){this.provideMetaData()}provideMetaData(){this.logos=this.coreService.getLogos()}}).ctorParameters=()=>[{type:ar.pX}],Me);Ge=(0,R.gn)([(0,h.wA2)({selector:"awg-sparql-no-results",template:'<div class="text-center">\n    <p>Entschuldigung, Ihre SPARQL-Anfrage f\xfchrte leider zu keinem Ergebnis.</p>\n    <p>M\xf6glicherweise k\xf6nnen Sie Ihre Anfrage anpassen.</p>\n    <p>\n        Ausf\xfchrliche Informationen zu SPARQL finden Sie unter:\n        <a href="{{ logos.sparql.href }}">{{ logos.sparql.href }}</a\n        >.\n    </p>\n    <p>\n        <a href="{{ logos.sparql.href }}">\n            <img width="33%" src="{{ logos.sparql.src }}" alt="{{ logos.sparql.alt }}" />\n        </a>\n    </p>\n</div>\n',changeDetection:h.n4l.OnPush,styles:[sr()]})],Ge);var $e,lr=g(1612),ur=g.n(lr);let Qe=(($e=class{constructor(){this.clickedTableRequest=new h.vpe}ngOnInit(){}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}}).propDecorators={queryResult:[{type:h.IIB}],queryTime:[{type:h.IIB}],clickedTableRequest:[{type:h.r_U}]},$e);Qe=(0,R.gn)([(0,h.wA2)({selector:"awg-sparql-table",template:'<awg-table\n    *ngIf="queryResult"\n    [tableTitle]="\'SELECT Anfrage\'"\n    [headerInputData]="queryResult.head.vars"\n    [rowInputData]="queryResult.body.bindings"\n    (clickedTableValueRequest)="onTableNodeClick($event)"\n    (clickedTableRowRequest)="(undefined)"></awg-table>\n',changeDetection:h.n4l.OnPush,styles:[ur()]})],Qe);var U,hr=g(1362),dr=g.n(hr);function mt(r){return new RegExp("^(?:"+r.join("|")+")$","i")}mt([]);var yt=mt(["@prefix","@base","a"]),xt=/[*+\-<>=&|]/;function vt(r,e){var t=r.next();if(U=null,"<"==t&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==t||"'"==t)return e.tokenize=function fr(r){return function(e,t){for(var i,n=!1;null!=(i=e.next());){if(i==r&&!n){t.tokenize=vt;break}n=!n&&"\\"==i}return"string"}}(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return U=t,null;if("#"==t)return r.skipToEnd(),"comment";if(xt.test(t))return r.eatWhile(xt),null;if(":"==t)return"operator";if(r.eatWhile(/[_\w\d]/),":"==r.peek())return"variableName.special";var n=r.current();return yt.test(n)?"meta":t>="A"&&t<="Z"?"comment":"keyword"}function ge(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function Be(r){r.indent=r.context.indent,r.context=r.context.prev}const gr={name:"turtle",startState:function(){return{tokenize:vt,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&null==e.context.align&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if("comment"!=t&&e.context&&null==e.context.align&&"pattern"!=e.context.type&&(e.context.align=!0),"("==U)ge(e,")",r.column());else if("["==U)ge(e,"]",r.column());else if("{"==U)ge(e,"}",r.column());else if(/[\]\}\)]/.test(U)){for(;e.context&&"pattern"==e.context.type;)Be(e);e.context&&U==e.context.type&&Be(e)}else"."==U&&e.context&&"pattern"==e.context.type?Be(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?ge(e,"pattern",r.column()):"pattern"==e.context.type&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var n=e&&e.charAt(0),i=r.context;if(/[\]\}]/.test(n))for(;i&&"pattern"==i.type;)i=i.prev;var s=i&&n==i.type;return i?"pattern"==i.type?i.col:i.align?i.col+(s?0:1):i.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var He;let Ue=((He=class{constructor(){this.errorMessageRequest=new h.vpe,this.performQueryRequest=new h.vpe,this.resetTriplesRequest=new h.vpe,this.updateTriplesRequest=new h.vpe,this.cmTurtleMode=gr}onEditorInputChange(e){this.updateTriplesRequest.emit(e)}performQuery(){this.triples?this.performQueryRequest.emit():this.errorMessageRequest.emit(new ee.Kb("Empty triples","Please enter triple content."))}resetTriples(){this.resetTriplesRequest.emit()}preventPanelCollapseOnFullscreen(e){this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-triples":""}}).propDecorators={triplesAcc:[{type:h.i9L,args:["triplesAcc"]}],triples:[{type:h.IIB}],isFullscreen:[{type:h.IIB}],errorMessageRequest:[{type:h.r_U}],performQueryRequest:[{type:h.r_U}],resetTriplesRequest:[{type:h.r_U}],updateTriplesRequest:[{type:h.r_U}]},He);Ue=(0,R.gn)([(0,h.wA2)({selector:"awg-triples-editor",template:'<ngb-accordion\n    #triplesAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-triples" title="RDF Triples">\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <awg-codemirror\n                ngDefaultControl\n                [mode]="cmTurtleMode"\n                [(content)]="triples"\n                (contentChange)="onEditorInputChange($event)"></awg-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="awg-graph-visualizer-triples-handle-buttons mt-2">\n                <button class="btn btn-outline-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-warning" (click)="resetTriples()">Reset</button>\n                <button class="btn btn-danger" (click)="onEditorInputChange(\'\')">Clear</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n',changeDetection:h.n4l.OnPush,styles:[dr()]})],Ue);var Ve,br=g(7109),mr=g.n(br);let Ze=((Ve=class{}).propDecorators={queryType:[{type:h.IIB}]},Ve);Ze=(0,R.gn)([(0,h.wA2)({selector:"awg-unsupported-type-results",template:'<ngb-accordion activeIds="awg-graph-visualizer-unsupported-query-type-result">\n    <ngb-panel id="awg-graph-visualizer-unsupported-query-type-result" title="Resultat">\n        <ng-template ngbPanelContent>\n            <p class="text-center">\n                Sorry, but the requested SPARQL query type {{ queryType | uppercase }} is not supported yet.\n            </p>\n            <p class="text-center">Please try a CONSTRUCT or SELECT query instead.</p>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n',changeDetection:h.n4l.OnPush,styles:[mr()]})],Ze);var yr=g(5861);var _e,vr=g(6407),wr=g.n(vr),Rr=g(2076),wt=g(515);let se=((_e=class{constructor(e,t){this.graphVisualizerService=e,this.toastService=t,this.defaultForceGraphHeight=500}ngOnInit(){this.resetTriples(),this.resetQuery()}resetTriples(){!this.graphRDFInputData.triples||(this.triples=this.graphRDFInputData.triples)}resetQuery(e){if(!this.graphRDFInputData.queryList)return;this.queryList=JSON.parse(JSON.stringify(this.graphRDFInputData.queryList));const t=e?this.queryList.find(n=>e.queryLabel===n.queryLabel&&e.queryType===n.queryType)||e:this.queryList[0];this.query={...t},this.performQuery()}performQuery(){if(this.query.queryString=this.graphVisualizerService.checkNamespacesInQuery(this.query.queryString,this.triples),this.query.queryType=this.graphVisualizerService.getQuerytype(this.query.queryString),"construct"===this.query.queryType||"select"===this.query.queryType){const e=this._queryLocalStore(this.query.queryType,this.query.queryString,this.triples);this.queryResult$=(0,Rr.D)(e)}else this.queryResult$=wt.E}onGraphNodeClick(e){!e||console.info("GraphVisualizerComponent# graphClick on node",e)}onTableNodeClick(e){!e||console.info("GraphVisualizerComponent# tableClick on URI",e)}showErrorMessage(e){if(!e||!e.message)return;const t=new ee.FN(e.message,{header:e.name,classname:"bg-danger text-light",delay:e.duration});this.toastService.add(t),console.error(e.name,":",e.message)}_queryLocalStore(e,t,n){var i=this;return(0,yr.Z)(function*(){const s=Date.now();let a;try{a=yield i.graphVisualizerService.doQuery(e,t,n),i.queryTime=Date.now()-s}catch(o){console.error("#queryLocalstore got error:",o),o.message&&o.name&&(-1!==o.message.indexOf("undefined")&&i.showErrorMessage(new ee.Kb(o.name,"The query did not return any results.",5e3)),i.showErrorMessage(new ee.Kb(o.name,o.message,5e3))),i.queryTime=Date.now()-s,a=[]}return a})()}}).ctorParameters=()=>[{type:ie},{type:ee.kl}],_e.propDecorators={fs:[{type:h.i9L,args:["fs"]}],graphRDFInputData:[{type:h.IIB}],isFullscreen:[{type:h.IIB}]},_e);se=(0,R.gn)([(0,h.wA2)({selector:"awg-graph-visualizer",template:'\x3c!-- Data: Triples, SPARQL query, result --\x3e\n<div #fs class="row awg-graph-visualizer" [class.is-fullscreen]="isFullscreen" *ngIf="graphRDFInputData">\n    <div [ngClass]="isFullscreen ? \'col-4 col-lg-3 px-0 awg-fullscreen\' : \'col-12\'">\n        <div [ngClass]="{ row: !isFullscreen }">\n            <div [ngClass]="{ \'col-6 pe-lg-0\': !isFullscreen }">\n                \x3c!-- awg-graph-triples-editor --\x3e\n                <awg-triples-editor\n                    [triples]="triples"\n                    [isFullscreen]="isFullscreen"\n                    (errorMessageRequest)="showErrorMessage($event)"\n                    (performQueryRequest)="performQuery()"\n                    (resetTriplesRequest)="resetTriples()"\n                    (updateTriplesRequest)="triples = $event"></awg-triples-editor>\n            </div>\n\n            <div [ngClass]="{ \'col-6 ps-lg-0\': !isFullscreen }">\n                \x3c!-- awg-graph-sparql-editor --\x3e\n                <awg-sparql-editor\n                    [queryList]="queryList"\n                    [query]="query"\n                    [isFullscreen]="isFullscreen"\n                    (errorMessageRequest)="showErrorMessage($event)"\n                    (performQueryRequest)="performQuery()"\n                    (resetQueryRequest)="resetQuery($event)"\n                    (updateQueryStringRequest)="query.queryString = $event"></awg-sparql-editor>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- Results --\x3e\n    <div [ngClass]="isFullscreen ? \'col-8 col-lg-9 px-0 awg-fullscreen\' : \'col-12\'">\n        \x3c!-- CONSTRUCT --\x3e\n        \x3c!-- awg-graph-construct-result --\x3e\n        <awg-construct-results\n            #queryConstructResultAcc\n            *ngIf="query.queryType === \'construct\'; else querySelectResultAcc"\n            [queryResult$]="queryResult$"\n            [defaultForceGraphHeight]="isFullscreen ? 1000 : defaultForceGraphHeight"\n            [isFullscreen]="isFullscreen"\n            (clickedNodeRequest)="onGraphNodeClick($event)"></awg-construct-results>\n\n        \x3c!-- SELECT --\x3e\n        \x3c!-- awg-graph-select-result --\x3e\n        <ng-template #querySelectResultAcc>\n            <awg-select-results\n                *ngIf="query.queryType === \'select\'; else queryUnsupportedTypeAcc"\n                [queryResult$]="queryResult$"\n                [queryTime]="queryTime"\n                [isFullscreen]="isFullscreen"\n                (clickedTableRequest)="onTableNodeClick($event)"></awg-select-results>\n        </ng-template>\n\n        \x3c!-- OTHERS --\x3e\n        \x3c!-- awg-graph-unsupported-query-type-result --\x3e\n        <ng-template #queryUnsupportedTypeAcc>\n            <awg-unsupported-type-results [queryType]="query.queryType"></awg-unsupported-type-results>\n        </ng-template>\n    </div>\n</div>\n\n<awg-toast aria-live="polite" aria-atomic="true"></awg-toast>\n',changeDetection:h.n4l.Default,styles:[wr()]})],se);let Xe=class{};Xe=(0,R.gn)([(0,h.LVF)({imports:[I.m],declarations:[ve,Ae,se,J,Le,ze,Ge,Qe,Ue,Ze],exports:[se],providers:[ie,J]})],Xe);var Rt=g(5867);var be,Tr=g(1548),Cr=g.n(Tr),Ir=g(6895),Pr=g(3900),Er=g(262),Nr=g(2539),St=g(3212);let me=((be=class{constructor(e,t,n){this.editionDataService=e,this.editionService=t,this.document=n,this.isFullscreen=!1,this.faExpand=V.TL5,this.faCompress=V.Qj4,this.GRAPH_IMAGES={OP12:"",OP25:Nr.w8.GRAPH_IMAGE_OP25.route},this.errorObject=null,this.ref=this}onKeydownHandler(e){!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(this.isFullscreen=!1)}ngOnInit(){this.getEditionGraphData()}getEditionGraphData(){this.editionGraphData$=this.editionService.getEditionComplex().pipe((0,Pr.w)(e=>(this.editionComplex=e,this.editionDataService.getEditionGraphData(this.editionComplex))),(0,Er.K)(e=>(this.errorObject=e,wt.E)))}openFullscreen(){const e=this.child.fs.nativeElement;this.isFullscreen=!0,!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}closeFullscreen(){this.document.exitFullscreen?this.document.exitFullscreen():this.document.mozCancelFullScreen?this.document.mozCancelFullScreen():this.document.webkitExitFullscreen?this.document.webkitExitFullscreen():this.document.msExitFullscreen&&this.document.msExitFullscreen(),this.isFullscreen=!1}}).ctorParameters=()=>[{type:St.Ko},{type:St.OE},{type:void 0,decorators:[{type:h.tBr,args:[Ir.K0]}]}],be.propDecorators={child:[{type:h.i9L,args:[se]}],isFullscreen:[{type:h.pfw,args:["class.is-fullscreen"]}],onKeydownHandler:[{type:h.L6J,args:["document:fullscreenchange",["$event"]]}]},be);me=(0,R.gn)([(0,h.wA2)({selector:"awg-edition-graph",template:'\x3c!-- content: edition graph --\x3e\n<div>\n    \x3c!-- modal --\x3e\n    <awg-modal #modal></awg-modal>\n\n    \x3c!-- graph --\x3e\n    <div class="awg-graph-view p-5 border rounded-3" *ngIf="editionGraphData$ | async as editionGraphData; else error">\n        <div *ngFor="let graph of editionGraphData.graph">\n            \x3c!-- graph description --\x3e\n            <div class="awg-graph-description">\n                <p>\n                    So weit vorhanden, pr\xe4sentiert die vorliegende Ansicht Graph-Visualisierungen des ausgew\xe4hlten\n                    Editionsbereichs: Der <em>statische Graph</em> vermittelt dabei einen von den jeweiligen Editoren\n                    fixierten \xdcberblick editionsrelevanter Zusammenh\xe4nge und Abh\xe4ngigkeiten, der\n                    <em>dynamische Graph</em> bietet zus\xe4tzlich einen interaktiven Zugang zu dem zugrundeliegenden\n                    Datenbestand.\n                    <span class="text-danger"\n                        >Diese Funktionalit\xe4t ist noch nicht f\xfcr alle Skizzenbestandteile verf\xfcgbar, wird aber\n                        sukzessive erg\xe4nzt.</span\n                    >\n                </p>\n                <ng-container *ngIf="graph.description">\n                    <p\n                        *ngFor="let description of graph.description"\n                        [compile-html]="description"\n                        [compile-html-ref]="ref"></p>\n                </ng-container>\n            </div>\n\n            \x3c!-- dynamic graph --\x3e\n            <div class="awg-graph-dynamic" *ngIf="graph.rdfData && graph.rdfData.triples && graph.rdfData.queryList">\n                <h4>\n                    Dynamischer Graph\n                    <button\n                        type="button"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="modal.open(\'HINT_EDITION_GRAPH\')">\n                        Hinweise zur Nutzung\n                    </button>\n                    <button\n                        type="button"\n                        title="Open fullscreen"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="openFullscreen()"\n                        *ngIf="!isFullscreen">\n                        <fa-icon [icon]="faExpand"></fa-icon>\n                    </button>\n                    <button\n                        type="button"\n                        title="Close fullscreen"\n                        class="btn btn-sm btn-info ms-2"\n                        (click)="closeFullscreen()"\n                        *ngIf="isFullscreen">\n                        <fa-icon [icon]="faCompress"></fa-icon>\n                    </button>\n                </h4>\n                <p>\n                    Diese interaktive Visualisierung basiert auf Mads Holten\'s\n                    <a href="https://github.com/MadsHolten/sparql-visualizer">SPARQL Visualizer</a>. Sie modelliert den\n                    aktuellen Skizzenkomplex in Form eines <a href="https://www.w3.org/RDF/">RDF</a>-Graphen. Die\n                    zugrundeliegenden RDF-Daten sind unter dem Punkt <em>RDF Triples</em> einsehbar und lokal\n                    editierbar. Eine Filterung und Eingrenzung dieser RDF-Daten kann mithilfe der Abfragesprache\n                    <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a>\n                    unter dem Punkt <em>SPARQL Abfrage</em> vorgenommen werden; in der Voreinstellung werden hierbei\n                    alle vorhandenen Triples abgefragt.\n                </p>\n                <awg-graph-visualizer\n                    [graphRDFInputData]="graph.rdfData"\n                    [isFullscreen]="isFullscreen"></awg-graph-visualizer>\n            </div>\n\n            \x3c!-- static image --\x3e\n            <div class="awg-graph-static mt-3" *ngIf="graph.staticImage && graph.staticImage !== \'\'">\n                <h4>Statischer Graph</h4>\n                <div [compile-html]="graph.staticImage" [compile-html-ref]="ref"></div>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- error message --\x3e\n    <ng-template #error>\n        <div class="errorMessage" *ngIf="errorObject">\n            <div class="col-12 text-center">\n                <div class="alert alert-danger">{{ errorObject | json }}</div>\n            </div>\n        </div>\n    </ng-template>\n</div>\n',changeDetection:h.n4l.OnPush,styles:[Cr()]})],me);const qr=[{path:"",component:me,data:{title:"AWG Online Edition \u2013 Graph"}}],Fr=[me];let Ke=class{};Ke=(0,R.gn)([(0,h.LVF)({imports:[Rt.Bz.forChild(qr)],exports:[Rt.Bz]})],Ke);let We=class{};We=(0,R.gn)([(0,h.LVF)({imports:[I.m,Xe,Ke],declarations:[Fr]})],We)},6643:C=>{let O;C.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window<"u"?window:global):g=>(O||(O=Promise.resolve())).then(g).catch(R=>setTimeout(()=>{throw R},0))},1548:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},1818:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},8576:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,'#awg-force-graph-container {\n  position: relative;\n  width: 100%;\n}\n#awg-force-graph-container > .awg-force-graph-icon-bar {\n  position: relative;\n  width: 100%;\n}\n\n.awg-force-graph-panel-container {\n  position: inherit;\n  height: 100%;\n}\n\n/* slider */\n.input-group.awg-force-graph-zoom-slider-container {\n  flex-wrap: nowrap;\n  width: auto;\n}\n.input-group.awg-force-graph-zoom-slider-container > :not(:first-child) {\n  margin-left: 0px !important;\n}\n\n#slider-label.input-group-text {\n  min-width: 50px;\n  color: #149b9e;\n}\n\n/* slider input */\ninput[type=range].awg-force-graph-zoom-slider {\n  width: 100%;\n  background-color: transparent;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus {\n  outline: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-upper {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-webkit-slider-runnable-track {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-runnable-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 29px;\n  cursor: pointer;\n  -moz-margin-start: fill;\n  margin-right: fill;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-thumb {\n  width: 15px;\n  height: 27px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-track {\n  background: transparent;\n  border-color: transparent;\n  border-width: 7.4px 0;\n  color: transparent;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-upper {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  margin-top: 0px;\n  /*Needed to keep the Edge thumb centred*/\n}\n\n/* Simulation nodes */\n:host ::ng-deep .node {\n  stroke: #fff;\n  fill: #ddd;\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .blank {\n  stroke: #fff;\n  fill: #000 !important;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .blank.instance {\n  stroke: #fff;\n  fill: #000;\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .class {\n  stroke: #fff;\n  fill: rgb(158, 0, 0);\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .instance {\n  stroke: #fff;\n  fill: rgb(32, 178, 170);\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .instance-space {\n  stroke: #fff;\n  fill: rgb(0, 191, 255);\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .instance-spaceType {\n  stroke: #fff;\n  fill: rgb(0, 0, 139);\n  stroke-width: 1.5px;\n}\n\n:host ::ng-deep .link {\n  fill: none;\n  stroke: #999;\n  stroke-opacity: 0.6;\n  stroke-width: 1px;\n}\n\n:host ::ng-deep marker {\n  stroke: #999;\n  fill: rgba(124, 240, 10, 0);\n}\n\n:host ::ng-deep .node-text {\n  font: 15px "Roboto", sans-serif;\n  fill: black;\n}\n\n:host ::ng-deep .link-text {\n  font: 13px "Roboto", sans-serif;\n  fill: grey;\n}',""]),C.exports=I.toString()},6407:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,":host::ng-deep .awg-fullscreen .collapse.show {\n  height: 100vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-triples.collapse.show {\n  height: 45vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-query.collapse.show {\n  height: 50vh;\n}",""]),C.exports=I.toString()},6627:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},9063:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},322:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},1612:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"ngb-highlight ::ng-deep .ngb-highlight {\n  font-weight: 700;\n  background: yellow;\n}",""]),C.exports=I.toString()},1362:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()},7109:(C,O,g)=>{var R=g(135),I=g(479)(R);I.push([C.id,"",""]),C.exports=I.toString()}}]);