<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>awg-app documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
        <link rel="stylesheet" href="../styles/Readthedocs.css">
    </head>
    <body>
          <script>
               // Blocking script to avaoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);

               if ($darkModeToggles.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">awg-app documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">












<ol class="breadcrumb">
  <li class="breadcrumb-item">Classes</li>
  <li class="breadcrumb-item" >FolioCalculationLine</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/views/edition-view/models/folio-calculation.model.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>The FolioCalculationLine class.</p>
<p>It is used in the context of the edition folio convolutes
to calculate the values of a line on the folio canvas.</p>
<p>Exposed to be used throughout <a href="../modules/EditionSheetsModule.html">EditionSheetsModule</a>.</p>

            </p>




            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#endPoint" >endPoint</a>
                            </li>
                            <li>
                                <a href="#startPoint" >startPoint</a>
                            </li>
                        </ul>
                    </td>
                </tr>






        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(startPoint: <a href="../classes/FolioCalculationPoint.html" target="_self">FolioCalculationPoint</a>, endPoint: <a href="../classes/FolioCalculationPoint.html" target="_self">FolioCalculationPoint</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="69" class="link-to-prism">src/app/views/edition-view/models/folio-calculation.model.ts:69</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Constructor of the FolioCalculationLine class.</p>
<p>It initializes the class with two points for start and end.</p>
</div>
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Description</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>startPoint</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/FolioCalculationPoint.html" target="_self" >FolioCalculationPoint</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                        <td>
                                                                <p>The given starting point.</p>

                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>endPoint</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/FolioCalculationPoint.html" target="_self" >FolioCalculationPoint</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                        <td>
                                                                <p>The given ending point.</p>

                                                        </td>
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="endPoint"></a>
                    <span class="name">
                        <span ><b>endPoint</b></span>
                        <a href="#endPoint"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/FolioCalculationPoint.html" target="_self" >FolioCalculationPoint</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="69" class="link-to-prism">src/app/views/edition-view/models/folio-calculation.model.ts:69</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>The ending point of a line (FolioCalculationPoint).</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="startPoint"></a>
                    <span class="name">
                        <span ><b>startPoint</b></span>
                        <a href="#startPoint"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/FolioCalculationPoint.html" target="_self" >FolioCalculationPoint</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="64" class="link-to-prism">src/app/views/edition-view/models/folio-calculation.model.ts:64</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>The starting point of a line (FolioCalculationPoint).</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
</section>







    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { FolioSettings } from &#x27;./folio-settings.model&#x27;;
import { Folio, FolioContent, FolioSection } from &#x27;./folio.model&#x27;;

/**
 * The FolioCalculationPoint class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a point on the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculationPoint {
    /**
     * The x value (in px) of a point.
     */
    x: number;

    /**
     * The y value (in px) of a point.
     */
    y: number;

    /**
     * Method: add.
     *
     * It adds x and y values (in px) to an existing point.
     *
     * @param {number} addX Add to x value.
     * @param {number} addY Add to y value.
     */
    add: (addX: number, addY: number) &#x3D;&gt; FolioCalculationPoint;

    /**
     * Constructor of the FolioCalculationPoint class.
     *
     * It initializes the class with values for x and y (in px).
     *
     * @param {number} x The given x value (in px).
     * @param {number} y The given y value (in px).
     */
    constructor(x: number, y: number) {
        this.x &#x3D; x;
        this.y &#x3D; y;
        this.add &#x3D; (addX: number, addY: number) &#x3D;&gt; {
            this.x +&#x3D; addX;
            this.y +&#x3D; addY;
            return this;
        };
    }
}

/**
 * The FolioCalculationLine class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a line on the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculationLine {
    /**
     * The starting point of a line (FolioCalculationPoint).
     */
    startPoint: FolioCalculationPoint;

    /**
     * The ending point of a line (FolioCalculationPoint).
     */
    endPoint: FolioCalculationPoint;

    /**
     * Constructor of the FolioCalculationLine class.
     *
     * It initializes the class with two points for start and end.
     *
     * @param {FolioCalculationPoint} startPoint The given starting point.
     * @param {FolioCalculationPoint} endPoint The given ending point.
     */
    constructor(startPoint: FolioCalculationPoint, endPoint: FolioCalculationPoint) {
        this.startPoint &#x3D; startPoint;
        this.endPoint &#x3D; endPoint;
    }
}

/**
 * The FolioCalculationContentItemCornerPoints class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a content item&#x27;s corners on the folio canvas.
 *
 * Not exposed, only called internally from {@link FolioCalculation}.
 */
export class FolioCalculationContentItemCornerPoints {
    /**
     * The upper left corner point of a content item (FolioCalculationPoint).
     */
    upperLeftCorner: FolioCalculationPoint;

    /**
     * The upper right corner point of a content item (FolioCalculationPoint).
     */
    upperRightCorner: FolioCalculationPoint;

    /**
     * The lower right corner point of a content item (FolioCalculationPoint).
     */
    lowerRightCorner: FolioCalculationPoint;

    /**
     * The lower left corner point of a content item (FolioCalculationPoint).
     */
    lowerLeftCorner: FolioCalculationPoint;

    /**
     * Constructor of the FolioCalculationContentItemCornerPoints class.
     *
     * It initializes the class with four points
     * for upper and lower left and upper and lower right corners.
     *
     * @param {FolioCalculationContentItem} calculatedContentItem The given calculated content item.
     */
    constructor(calculatedContentItem: FolioCalculationContentItem) {
        this.upperLeftCorner &#x3D; new FolioCalculationPoint(calculatedContentItem.startX, calculatedContentItem.startY);
        this.upperRightCorner &#x3D; new FolioCalculationPoint(calculatedContentItem.endX, calculatedContentItem.startY);
        this.lowerRightCorner &#x3D; new FolioCalculationPoint(calculatedContentItem.endX, calculatedContentItem.endY);
        this.lowerLeftCorner &#x3D; new FolioCalculationPoint(calculatedContentItem.startX, calculatedContentItem.endY);
    }
}

/**
 * The FolioCalculationContentItemCache class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a content item cache on the folio canvas.
 *
 * Not exposed, only called internally from {@link FolioCalculation}.
 */
class FolioCalculationContentItemCache {
    /**
     * The section of a content item (FolioSection).
     */
    section: FolioSection;

    /**
     * The corner points of a content item (FolioCalculationContentItemCornerPoints).
     */
    cornerPoints: FolioCalculationContentItemCornerPoints;
}

/**
 * The FolioCalculationContentItem class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a content item on the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculationContentItem {
    /**
     * The correction value for the offset of the content item (number).
     */
    offsetCorrection: number;

    /**
     * The width including offset of the content item (number).
     */
    widthWithOffset: number;

    /**
     * The width of the content item (number).
     */
    width: number;

    /**
     * The height of the content item (number).
     */
    height: number;

    /**
     * The system range of the content item (number).
     */
    systemRange: number;

    /**
     * The start position (x-value) of the index of the content item (number).
     */
    startXIndex: number;

    /**
     * The start position (y-value) of the index of the content item (number).
     */
    startYIndex: number;

    /**
     * The start position (x-value) of the content item (number).
     */
    startX: number;

    /**
     * The end position (x-value) of the content item (number).
     */
    endX: number;

    /**
     * The start position (y-value) of the content item (number).
     */
    startY: number;

    /**
     * The end position (y-value) of the content item (number).
     */
    endY: number;

    /**
     * The current content item (FolioCalculationContentItemCache).
     */
    current: FolioCalculationContentItemCache;

    /**
     * The previous content item (FolioCalculationContentItemCache).
     */
    previous: FolioCalculationContentItemCache;

    /**
     * The label for the id of the edition complex of the content item (string).
     */
    complexId: string;

    /**
     * The label for the id of the content item (string).
     */
    sheetId: string;

    /**
     * The label for the sigle of the content item (string).
     */
    sigle: string;

    /**
     * The label for the sigle addendum of the content item (string).
     */
    sigleAddendum: string;

    /**
     * The boolean flag if the content item can be selected..
     */
    selectable: boolean;

    /**
     * The boolean flag if the content item is reversed.
     */
    reversed: boolean;

    /**
     * The link to a convolute description in the critical report.
     */
    linkTo: string;
}

/**
 * The FolioCalculationSheet class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of a sheet on the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculationSheet {
    /**
     * The offset of the sheet (FolioCalculationPoint).
     */
    offset: FolioCalculationPoint;

    /**
     * The width of the sheet (number).
     */
    width: number;

    /**
     * The height of the sheet (number).
     */
    height: number;

    /**
     * The optional folio id of the sheet (string).
     */
    folioId?: string;

    /**
     * The optional upper left corner point of the sheet (FolioCalculationPoint).
     */
    upperLeftCorner?: FolioCalculationPoint;

    /**
     * The optional lower right corner point of the sheet (FolioCalculationPoint).
     */
    lowerRightCorner?: FolioCalculationPoint;

    /**
     * Constructor of the FolioCalculationSheet class.
     *
     * It initializes the class with values from folio settings, the folio id and zoom factor.
     *
     * @param {FolioSettings} folioSettings The given folio settings.
     * @param {string} folioId The given folio id.
     */
    constructor(folioSettings: FolioSettings, folioId: string) {
        this.folioId &#x3D; folioId;
        this.offset &#x3D; new FolioCalculationPoint(folioSettings.initialOffsetX, folioSettings.initialOffsetY);
        this.width &#x3D; folioSettings.formatX * folioSettings.factor;
        this.height &#x3D; folioSettings.formatY * folioSettings.factor;
        this.upperLeftCorner &#x3D; this.offset;
        this.lowerRightCorner &#x3D; new FolioCalculationPoint(this.width, this.height);
    }
}

/**
 * The FolioCalculationSystems class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate the values of the systems on the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculationSystems {
    /**
     * The width of the systems (number).
     */
    width: number;

    /**
     * The left margin of the systems (number).
     */
    leftMargin: number;

    /**
     * The right margin of the systems (number).
     */
    rightMargin: number;

    /**
     * The upper margin of the systems (number).
     */
    upperMargin: number;

    /**
     * The margins of the systems (number).
     */
    margins: number;

    /**
     * The start position (x-value) of the systems (number).
     */
    startX: number;

    /**
     * The end position (x-value) of the systems (number).
     */
    endX: number;

    /**
     * The start position (y-value) of the systems (number).
     */
    startY: number;

    /**
     * The array of y-value arrays for the systems (number).
     */
    yArray: number[][];

    /**
     * The start position (x-value) of the labels of the systems (number).
     */
    labelStartX: number;

    /**
     * The correction value for the offset of the labels of the systems (number).
     */
    labelOffsetCorrection: number;

    /**
     * The optional line label array of the systems (FolioCalculationPoint[]).
     */
    lineLabelArray?: FolioCalculationPoint[];

    /**
     * The optional array of line arrays of the systems (FolioCalculationLine[][]).
     */
    lineArrays?: FolioCalculationLine[][];
}

/**
 * The FolioCalculation class.
 *
 * It is used in the context of the edition folio convolutes
 * to calculate all the values needed for the folio canvas.
 *
 * Exposed to be used throughout {@link EditionSheetsModule}.
 */
export class FolioCalculation {
    /**
     * The correction value for the offset of the folio items (number).
     */
    itemsOffsetCorrection: number;

    /**
     * The number of systems (number).
     */
    numberOfSystems: number;

    /**
     * The zoom factor (number).
     */
    zoomFactor: number;

    /**
     * The calculated values for the sheet
     * of a folio (FolioCalculationSheet).
     */
    sheet: FolioCalculationSheet;

    /**
     * The calculated values for the systems
     * of a folio (FolioCalculationSystems).
     */
    systems: FolioCalculationSystems;

    /**
     * The calculated values for the array of content items
     * of a folio (FolioCalculationContentItem[]).
     */
    contentItemsArray: FolioCalculationContentItem[];

    /**
     * Constructor of the FolioCalculation class.
     *
     * It initializes the class with values from folio settings, folio data and itemsOffset correction.
     *
     * @param {FolioSettings} folioSettings The given folio settings.
     * @param {Folio} folioData The given folio data.
     * @param {number} [itemsOffsetCorrection] The optional given itemsOffset correction.
     */
    constructor(folioSettings: FolioSettings, folioData: Folio, itemsOffsetCorrection?: number) {
        this.itemsOffsetCorrection &#x3D; itemsOffsetCorrection || 0;
        this.numberOfSystems &#x3D; folioData.systems ? parseInt(folioData.systems, 10) : 0;
        this.zoomFactor &#x3D; folioSettings.factor;

        this._calculateFolio(folioSettings, folioData);
    }

    /**
     * Private method: _calculateFolio.
     *
     * It calls the calculation methods for the sheet,
     * systems and contentItemsArray of a folio.
     *
     * @param {FolioSettings} folioSettings The given folio settings.
     * @param {Folio} folioData The given folio data.
     *
     * @returns {void} Sets the sheet, systems and contentItemsArray variables.
     */
    private _calculateFolio(folioSettings: FolioSettings, folioData: Folio): void {
        this.sheet &#x3D; this._calculateSheet(folioSettings, folioData.folioId);
        this.systems &#x3D; this._calculateSystems();
        this.contentItemsArray &#x3D; this._calculateContentArray(folioData.content);
    }

    /**
     * Private method: _calculateSheet.
     *
     * It returns a FolioCalculationSheet class that provides
     * all the calculated values for the sheet of a folio.
     *
     * @param {FolioSettings} folioSettings The given folio settings.
     * @param {string} folioId The given folio id.
     *
     * @returns {FolioCalculationSheet} The calculated sheet.
     */
    private _calculateSheet(folioSettings: FolioSettings, folioId: string): FolioCalculationSheet {
        return new FolioCalculationSheet(folioSettings, folioId);
    }

    /**
     * Private method: _calculateSystems.
     *
     * It returns a FolioCalculationSystems class that provides
     * all the calculated values for the systems of a folio.
     *
     * @returns {FolioCalculationSystems} The calculated systems.
     */
    private _calculateSystems(): FolioCalculationSystems {
        // Init
        const calculatedSystems &#x3D; new FolioCalculationSystems();

        // Offset correction
        calculatedSystems.labelOffsetCorrection &#x3D; 4 / this.zoomFactor; // OffsetCorrection for system line labels dependent from zoom factor

        // X-values
        calculatedSystems.leftMargin &#x3D; this._round(this.sheet.width / 6, 2); // Reserve 1/6 of sheetWidth for left margin
        calculatedSystems.rightMargin &#x3D; this._round(calculatedSystems.leftMargin * 0.5, 2); // Right margin is 1/2 leftMargin
        calculatedSystems.margins &#x3D; calculatedSystems.leftMargin + calculatedSystems.rightMargin; // Outer margins

        calculatedSystems.width &#x3D; this.sheet.width - calculatedSystems.margins; // Sheet width minus outer margins
        calculatedSystems.startX &#x3D; this.sheet.upperLeftCorner.x + calculatedSystems.leftMargin; // Begin of sheet plus left margin
        calculatedSystems.endX &#x3D; calculatedSystems.startX + calculatedSystems.width; // Begin of system plus its width

        // Y-values
        calculatedSystems.upperMargin &#x3D; this._round(this.sheet.height / (this.numberOfSystems + 2), 2); // Reserve (1 / numberOfSystems plus two empty lines) of sheetHeight as offset
        calculatedSystems.startY &#x3D; this.sheet.upperLeftCorner.y + calculatedSystems.upperMargin; // Begin of sheet plus upper margin

        // Get y values for systems
        calculatedSystems.yArray &#x3D; this._getSystemYArray(calculatedSystems.upperMargin, calculatedSystems.startY);

        // System lines
        calculatedSystems.lineArrays &#x3D; calculatedSystems.yArray.map(lineArray &#x3D;&gt;
            lineArray.map(
                line &#x3D;&gt;
                    new FolioCalculationLine(
                        new FolioCalculationPoint(calculatedSystems.startX, line),
                        new FolioCalculationPoint(calculatedSystems.endX, line)
                    )
            )
        ); // Line is the y value

        // System numbers (labels)
        calculatedSystems.labelStartX &#x3D; this._round(
            calculatedSystems.startX - (calculatedSystems.leftMargin * 3) / 4,
            2
        ); // Place numbers 3/4 of left margin in front of system

        // Reduce start values with lineLabelOffsetCorrection to get start positions of numbers
        // LineArray[0] &#x3D; first line of a system
        calculatedSystems.lineLabelArray &#x3D; calculatedSystems.yArray.map(
            lineArray &#x3D;&gt;
                new FolioCalculationPoint(
                    calculatedSystems.labelStartX,
                    lineArray[0] - calculatedSystems.labelOffsetCorrection
                )
        );

        return calculatedSystems;
    }

    /**
     * Private method: _calculateContentArray.
     *
     * It provides all the calculated values for the content items of a folio.
     *
     * @param {FolioContent[]} contents The given folio contents.
     * @returns {FolioCalculationContentItem[]} The array of the calculated content items.
     */
    private _calculateContentArray(contents: FolioContent[]): FolioCalculationContentItem[] {
        // Init
        const calculatedContentItems: FolioCalculationContentItem[] &#x3D; [];

        // Iterate over items
        contents.forEach((content: FolioContent) &#x3D;&gt; {
            // Init
            const calculatedContentItem: FolioCalculationContentItem &#x3D; new FolioCalculationContentItem();
            calculatedContentItem.previous &#x3D; new FolioCalculationContentItemCache();
            calculatedContentItem.current &#x3D; new FolioCalculationContentItemCache();
            calculatedContentItem.previous.section &#x3D; new FolioSection(); // Reset prevSection
            calculatedContentItem.current.section &#x3D; new FolioSection(); // Reset currentSection
            let sectionPartition &#x3D; 1; // Default: 1 section

            // OffsetCorrection to avoid collision between items
            calculatedContentItem.offsetCorrection &#x3D; this.itemsOffsetCorrection;

            // Check if number of sections exist in data; if yes, apply value
            if (content[&#x27;sectionPartition&#x27;]) {
                sectionPartition &#x3D; content[&#x27;sectionPartition&#x27;];
            }

            // Check if sections exist
            if (content.sections) {
                // Check if sections length is bigger than sectionPartition
                const sectionsLength &#x3D; content.sections.length;
                if (sectionsLength &gt; sectionPartition) {
                    console.error(&#x27;Sections array is bigger than sectionPartition&#x27;);
                    return;
                }
                // Iterate over sections
                content.sections.forEach((section: FolioSection, sectionIndex: number) &#x3D;&gt; {
                    // Set section cache
                    this._setContentItemSectionCache(calculatedContentItem, section);

                    // Set main values for item
                    this._setContentItemMainValues(calculatedContentItem, section, sectionPartition, content);

                    // Set item corner points
                    calculatedContentItem.current.cornerPoints &#x3D; new FolioCalculationContentItemCornerPoints(
                        calculatedContentItem
                    );

                    calculatedContentItem.complexId &#x3D; content.complexId;
                    calculatedContentItem.sheetId &#x3D; content.sheetId;
                    calculatedContentItem.sigle &#x3D; content.sigle;
                    calculatedContentItem.sigleAddendum &#x3D; content.sigleAddendum;
                    calculatedContentItem.selectable &#x3D; content.selectable ?? true;
                    calculatedContentItem.reversed &#x3D; content.reversed ?? false;
                    calculatedContentItem.linkTo &#x3D; content.linkTo || &#x27;&#x27;;

                    calculatedContentItems.push(calculatedContentItem);
                });
            } else {
                console.error(&#x27;No sections array in content&#x27;, content);
            }
        });

        return calculatedContentItems;
    }

    /**
     * Private helper method for _calculateContentArray: _setContentItemMainValues.
     *
     * It calculates the main values for the content items of a folio.
     *
     * @param {FolioCalculationContentItem} calculatedContentItem The given calculated content item.
     * @param {FolioSection} section The given section.
     * @param {number} sectionPartition The given section partition.
     * @param {FolioContent} item The given folio content.
     * @returns {void} Calculates and sets the main values of the calculatedContentItem.
     */
    private _setContentItemMainValues(
        calculatedContentItem: FolioCalculationContentItem,
        section: FolioSection,
        sectionPartition: number,
        item: FolioContent
    ): void {
        if (!calculatedContentItem) {
            return;
        }

        // ItemsWidth
        calculatedContentItem.widthWithOffset &#x3D; this._round(this.systems.width / sectionPartition, 2);
        calculatedContentItem.width &#x3D; calculatedContentItem.widthWithOffset - this.itemsOffsetCorrection; // OffsetCorrection to avoid horizontal collision between items

        // ItemsHeight
        calculatedContentItem.systemRange &#x3D; section.endSystem - section.startSystem + 1;
        calculatedContentItem.height &#x3D; this._round(
            this.systems.upperMargin * calculatedContentItem.systemRange - this.itemsOffsetCorrection,
            2
        ); // OffsetCorrection to avoid vertical collision between items

        // Find item start indices
        calculatedContentItem.startYIndex &#x3D; section.startSystem - 1;
        calculatedContentItem.startXIndex &#x3D; 0;
        // Check if position exists ...
        if (section.position) {
            const position: number &#x3D; section.position;
            if (position &gt; sectionPartition) {
                // ... and is bigger than number of sections
                // Index remains 0
                console.error(
                    &#x27;Assuming position 1 because current position is bigger than number of sections for item &#x27;,
                    item
                );
            } else if (sectionPartition &gt; 1) {
                // ... or is smaller or equal to number of sections which is bigger 1
                // Than index is position - 1 (positions go from 1, 2, 3 to n)
                calculatedContentItem.startXIndex &#x3D; position - 1;
            }
        }
        // For other cases index remains 0 (default)

        // ItemsStartX
        // WidthWithOffset * startXIndex
        // Add half the offsetCorrection to systemStartX to center items
        calculatedContentItem.startX &#x3D; this._getContentItemStart(
            calculatedContentItem.widthWithOffset,
            calculatedContentItem.startXIndex,
            this.systems.startX,
            this.itemsOffsetCorrection / 2
        );
        calculatedContentItem.endX &#x3D; this._round(calculatedContentItem.startX + calculatedContentItem.width, 2);

        // ItemsStartY
        // Subtract half the offsetCorrection from systemStartY to center items
        calculatedContentItem.startY &#x3D; this._getContentItemStart(
            this.systems.upperMargin,
            calculatedContentItem.startYIndex,
            this.systems.startY,
            -this.itemsOffsetCorrection / 2
        );
        calculatedContentItem.endY &#x3D; this._round(calculatedContentItem.startY + calculatedContentItem.height, 2);
    }

    /**
     * Private helper method for _calculateContentArray: _setContentItemSectionCache.
     *
     * It caches the current and previous section of a calculated content item.
     *
     * @param {FolioCalculationContentItem} calculatedContentItem The given calculated content item.
     * @param {FolioSection} section The given section.
     * @returns {void} Caches the current and previous section of the calculatedContentItem.
     */
    private _setContentItemSectionCache(
        calculatedContentItem: FolioCalculationContentItem,
        section: FolioSection
    ): void {
        if (!calculatedContentItem) {
            return;
        }

        if (calculatedContentItem.current[&#x27;section&#x27;]) {
            calculatedContentItem.previous.section &#x3D; calculatedContentItem.current.section;
            calculatedContentItem.previous.cornerPoints &#x3D; calculatedContentItem.current.cornerPoints;
        }
        calculatedContentItem.current.section &#x3D; section;
    }

    /**
     * Private helper method for _calculateContentArray: _getContentItemStart.
     *
     * It calculates the start position of a content item of a folio.
     *
     * @param {number} offset The given offset.
     * @param {number} index The given index position (offset * index --&gt;
     * (X: start at item 1, 2, 3 etc; Y: start at system line 1, 2, 3 etc.)).
     * @param {number} systemStart The given horizontal(X) or vertical (Y) systemsMargins.
     * @param {number} [offsetCorrection] The optional given offset correction value (mostly needed to center items).
     * @returns {number} The start position for a calculatedContentItem.
     */
    private _getContentItemStart(
        offset: number,
        index: number,
        systemStart: number,
        offsetCorrection?: number
    ): number {
        let itemValue &#x3D; systemStart + offset * index;
        if (offsetCorrection) {
            itemValue +&#x3D; offsetCorrection;
        }
        return this._round(parseFloat(itemValue.toString()), 2);
    }

    /**
     * Private helper method for _calculateSystems: _getSystemYArray.
     *
     * It calculates the array of start positions of the systems of a folio.
     *
     * @param {number} offset The given offset.
     * @param {number} systemStartY The given (Y) systemsMargins (begin of sheet plus upper margin).
     * @param {number} [offsetCorrection] The optional given offset correction value (mostly needed to center items).
     * @returns {number[][]} The array of start position arrays (Y values) for the calculatedSystems.
     */
    private _getSystemYArray(offset: number, systemStartY: number, offsetCorrection?: number): number[][] {
        const arr &#x3D; [];
        // Iterate over systems and get their start position
        for (let i &#x3D; 0; i &lt; this.numberOfSystems; i++) {
            // Use the same method as for items to populate the systems array
            const yStartValue &#x3D; this._getContentItemStart(offset, i, systemStartY, offsetCorrection);
            arr[i] &#x3D; this._getSystemLineArray(yStartValue);
        }
        return arr;
    }

    /**
     * Private helper method for _calculateSystems: _getSystemLineArray.
     *
     * It calculates the start position of the lines per system of a folio.
     *
     * @param {number} y The Y start value of the first line of a system.
     * @returns {number[]} The start position array (Y values) of a system.
     */
    private _getSystemLineArray(y: number): number[] {
        if (!y) {
            return undefined;
        }

        const lineArray: number[] &#x3D; [];
        const lineSpaceFactor &#x3D; 1.5; // Factor to adjust the space between lines

        // Iterate from 0 to 4 (5 notation lines) and get start values for each line
        for (let i &#x3D; 0; i &lt; 5; i++) {
            lineArray[i] &#x3D; y + lineSpaceFactor * i * this.zoomFactor;
        }
        return lineArray;
    }

    /**
     * Private helper method for folio calculation model: _round.
     *
     * It rounds a given number to a given number of decimal places.
     * JS in-built round-method is sometimes not correct,
     * see: {@link http://www.jacklmoore.com/notes/rounding-in-javascript/}.
     *
     * @param {number} value The given input value to be rounded.
     * @param {number} decimals The number of decimal places to round to.
     * @returns {number} The rounded number.
     */
    private _round(value: number, decimals: number): number {
        if (Number.isNaN(value)) {
            return undefined;
        }
        return Number(Math.round(Number(value + &#x27;e&#x27; + decimals)) + &#x27;e-&#x27; + decimals);
    }
}
</code></pre>
    </div>
</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'FolioCalculationLine.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
