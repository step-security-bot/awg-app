(self.webpackChunkawg_app=self.webpackChunkawg_app||[]).push([[189],{7189:(T,ee,w)=>{"use strict";w.r(ee),w.d(ee,{EditionGraphModule:()=>He});var P=w(655),m=w(5e3),se=w(3762),L=w(3338),te=w(1451);let K=class{constructor(){this.clickedNodeRequest=new m.vpe}onGraphNodeClick(e){!e||this.clickedNodeRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}};K.propDecorators={queryResult$:[{type:m.IIB}],defaultForceGraphHeight:[{type:m.IIB}],isFullscreen:[{type:m.IIB}],clickedNodeRequest:[{type:m.r_U}]},K=(0,P.gn)([(0,m.wA2)({selector:"awg-construct-results",template:L,changeDetection:m.n4l.OnPush,styles:[te]})],K);var ae=w(5534),le=w(9020),X=w(7579),oe=w(8372),J=w(2722),z=w(801),N=w(22);class S{constructor(){this.nodes=[],this.links=[],this.nodeTriples=[]}}class E{constructor(e,t){this.source=e,this.target=t,this.predicate="",this.weight=1}}var M,r,ue,Q;(r=M||(M={})).link="link",r.node="node";class Ee{constructor(e,t){this.id=e,this.label=e,this.weight=1,this.type=t,this.owlClass=!1,this.instance=!1}}class dt{constructor(e,t,n){this.nodeSubject=e,this.nodePredicate=t,this.nodeObject=n}}!function(r){r.TURTLE="TURTLE",r.SPARQL="SPARQL"}(ue||(ue={})),function(r){r.SHORT="short",r.LONG="long"}(Q||(Q={}));class ${constructor(e,t){this.prefixName=e,this.prefixIri=t}}const ft=[new $("awg","https://edition.anton-webern.ch/webern-onto#"),new $("dbo","http://dbpedia.org/ontology/"),new $("dbp","http://dbpedia.org/property/"),new $("dbpedia","http://dbpedia.org/resource/"),new $("dc","http://purl.org/dc/elements/1.1/"),new $("dcterms","http://purl.org/dc/terms/"),new $("foaf","http://xmlns.com/foaf/0.1/"),new $("mo","http://purl.org/ontology/mo/"),new $("owl","http://www.w3.org/2002/07/owl#"),new $("prov","http://www.w3.org/ns/prov#"),new $("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),new $("rdfs","http://www.w3.org/2000/01/rdf-schema#"),new $("skos","http://www.w3.org/2004/02/skos/core#"),new $("xsd","http://www.w3.org/2001/XMLSchema#")];let ce=class{constructor(){this.defaultPrefixes=ft}transform(e,t){let n;switch(t){case Q.SHORT:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixIri)&&(n=e.replace(s.prefixIri,s.prefixName+":"))});break;case Q.LONG:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixName)&&(n=e.replace(s.prefixName+":",s.prefixIri))});break;default:const i=t;throw new Error(`The prefixForm must be ${Q.SHORT} or ${Q.LONG}, but was: ${i}.`)}return n||e}};ce=(0,P.gn)([(0,m.E6H)({name:"prefix",pure:!1})],ce);const ge="http://www.w3.org/1999/02/22-rdf-syntax-ns#",_e="http://www.w3.org/2001/XMLSchema#",Pe="http://www.w3.org/2000/10/swap/",U={xsd:{decimal:`${_e}decimal`,boolean:`${_e}boolean`,double:`${_e}double`,integer:`${_e}integer`,string:`${_e}string`},rdf:{type:`${ge}type`,nil:`${ge}nil`,first:`${ge}first`,rest:`${ge}rest`,langString:`${ge}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${Pe}reify#forSome`,forAll:`${Pe}reify#forAll`},log:{implies:`${Pe}log#implies`}};var pt=w(352),gt=w.n(pt);const{xsd:ye}=U,_t=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,Ze={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},bt=/[\x00-\x20<>\\"\{\}\|\^\`]/,mt={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},yt=/$0^/;class xt{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const t in this)!(t in mt)&&this[t]instanceof RegExp&&(this[t]=yt)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input,i=n.length;for(;;){let l,c;for(;l=this._newline.exec(n);)this._comments&&(c=this._comment.exec(l[0]))&&s("comment",c[1],"",this._line,l[0].length),n=n.substr(l[0].length,n.length),i=n.length,this._line++;if(!l&&(l=this._whitespace.exec(n))&&(n=n.substr(l[0].length,n.length)),this._endOfFile.test(n))return t&&(this._comments&&(c=this._comment.exec(n))&&s("comment",c[1],"",this._line,n.length),n=null,s("eof","","",this._line,0)),this._input=n;const o=this._line,x=n[0];let _="",d="",b="",g=null,f=0,h=!1;switch(x){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(f=1,_="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){h=!0;break}case"<":if(g=this._unescapedIri.exec(n))_="IRI",d=g[1];else if(g=this._iri.exec(n)){if(d=this._unescape(g[1]),null===d||bt.test(d))return a(this);_="IRI"}else n.length>1&&"<"===n[1]?(_="<<",f=2):this._n3Mode&&n.length>1&&"="===n[1]&&(_="inverse",f=2,d=">");break;case">":n.length>1&&">"===n[1]&&(_=">>",f=2);break;case"_":((g=this._blank.exec(n))||t&&(g=this._blank.exec(`${n} `)))&&(_="blank",b="_",d=g[1]);break;case'"':if(g=this._simpleQuotedString.exec(n))d=g[1];else if(({value:d,matchLength:f}=this._parseLiteral(n)),null===d)return a(this);(null!==g||0!==f)&&(_="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(g=this._simpleApostropheString.exec(n))d=g[1];else if(({value:d,matchLength:f}=this._parseLiteral(n)),null===d)return a(this);(null!==g||0!==f)&&(_="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(g=this._variable.exec(n))&&(_="var",d=g[0]);break;case"@":"literal"===this._previousMarker&&(g=this._langcode.exec(n))?(_="langcode",d=g[1]):(g=this._keyword.exec(n))&&(_=g[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){_=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(g=this._number.exec(n)||t&&(g=this._number.exec(`${n} `)))&&(_="literal",d=g[0],b="string"==typeof g[1]?ye.double:"string"==typeof g[2]?ye.decimal:ye.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(g=this._sparqlKeyword.exec(n))?_=g[0].toUpperCase():h=!0;break;case"f":case"t":(g=this._boolean.exec(n))?(_="literal",d=g[0],b=ye.boolean):h=!0;break;case"a":(g=this._shortPredicates.exec(n))?(_="abbreviation",d="a"):h=!0;break;case"=":this._n3Mode&&n.length>1&&(_="abbreviation",">"!==n[1]?(f=1,d="="):(f=2,d=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(f=1,_=x);break;default:h=!0}if(h&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(g=this._prefix.exec(n))?((g=this._prefixed.exec(n))||t&&(g=this._prefixed.exec(`${n} `)))&&(_="prefixed",b=g[1]||"",d=this._unescape(g[2])):(_="prefix",d=g[1]||"")),"^^"===this._previousMarker)switch(_){case"prefixed":_="type";break;case"IRI":_="typeIRI";break;default:_=""}if(!_)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?a(this):this._input=n;const y=f||g[0].length,R=s(_,d,b,o,y);this.previousToken=R,this._previousMarker=_,n=n.substr(y,n.length)}function s(l,c,o,x,_){const d=n?i-n.length:i,g={type:l,value:c,prefix:o,line:x,start:d,end:d+_};return e(null,g),g}function a(l){e(l._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(_t,(i,s,a,l)=>{if("string"==typeof s)return String.fromCharCode(Number.parseInt(s,16));if("string"==typeof a){let c=Number.parseInt(a,16);return c<=65535?String.fromCharCode(Number.parseInt(a,16)):String.fromCharCode(55296+((c-=65536)>>10),56320+(1023&c))}return l in Ze?Ze[l]:(t=!0,"")});return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let i=Math.max(this._literalClosingPos,n);for(;(i=e.indexOf(t,i))>0;){let s=0;for(;"\\"===e[i-s-1];)s++;if(s%2==0){const a=e.substring(n,i),l=a.split(/\r\n|\r|\n/).length-1,c=i+n;if(1===n&&0!==l||3===n&&this._lineMode)break;return this._line+=l,{value:this._unescape(a),matchLength:c}}i++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const n=[];let i;if(this._tokenizeToEnd((s,a)=>s?i=s:n.push(a),!0),i)throw i;return n}gt()(()=>this._tokenizeToEnd(t,!0))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",n=>{null!==this._input&&0!==n.length&&(this._pendingBuffer&&(n=Buffer.concat([this._pendingBuffer,n]),this._pendingBuffer=null),128&n[n.length-1]?this._pendingBuffer=n:(void 0===this._input?this._input=this._readStartingBom("string"==typeof n?n:n.toString()):this._input+=n,this._tokenizeToEnd(t,!1)))}),e.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)}),e.on("error",t)}}const{rdf:vt,xsd:ne}=U;let be,wt=0;const De={namedNode:function It(r){return new Ke(r)},blankNode:function Ft(r){return new Tt(r||"n3-"+wt++)},variable:function Et(r){return new Ct(r)},literal:function kt(r,e){if("string"==typeof e)return new he(`"${r}"@${e.toLowerCase()}`);let t=e?e.value:"";return""===t&&("boolean"==typeof r?t=ne.boolean:"number"==typeof r&&(Number.isFinite(r)?t=Number.isInteger(r)?ne.integer:ne.double:(t=ne.double,Number.isNaN(r)||(r=r>0?"INF":"-INF")))),""===t||t===ne.string?new he(`"${r}"`):new he(`"${r}"^^${t}`)},defaultGraph:function Pt(){return be},quad:Xe,triple:Xe},St=De;class Z{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof Z?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class Ke extends Z{get termType(){return"NamedNode"}}class he extends Z{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new Ke(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?ne.string:vt.langString}equals(e){return e instanceof he?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class Tt extends Z{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Ct extends Z{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}be=new class Nt extends Z{constructor(){return super(""),be||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};class qt extends Z{constructor(e,t,n,i){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=i||be}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function Xe(r,e,t,n){return new qt(r,e,t,n)}let Je=0;class je{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Ye(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),i=/trig/.test(t),s=/triple/.test(t),a=/quad/.test(t),l=this._n3Mode=/n3/.test(t),c=s||a;(this._supportsNamedGraphs=!(n||l))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||i||s||l),this._supportsRDFStar=""===t||/star|\*$/.test(t),c&&(this._resolveRelativeIRI=o=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new xt({lineMode:c,n3:l}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Je=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,i,s){const a=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:i,object:s,graph:t,inverse:!!a&&this._inversePredicate,blankPrefix:a?this._prefixes._:"",quantified:a?this._quantified:null}),a&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const i=this._resolveIRI(e.value);if(null===i)return this._error("Invalid IRI",e);n=this._namedNode(i);break;case"type":case"prefixed":const s=this._prefixes[e.prefix];if(void 0===s)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._namedNode(s+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,i=this._readListItem;const s=this._subject,a=this._contextStack,l=a[a.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==a.length&&"list"===a[a.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blankNode()),null===s?null===l.predicate?l.subject=n:l.object=n:this._emit(s,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._literal(this._literalValue,n),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const i=this._subject,s=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==i){const a=this._predicate,l=this._object;s?this._emit(l,a,i,n):this._emit(i,a,l,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const i=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,i,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const i=this._blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=i):(t=this._object,this._object=i),this._emit(t,n,i,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let n,i;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=t):(i=this._object,this._object=t),this._emit(t,n,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,i){this._callback(null,this._quad(e,t,n,i||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=Ae}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",i=-1,s=-1,a=0,l="/";for(;i<t;){switch(l){case":":if(s<0&&"/"===e[++i]&&"/"===e[++i])for(;(s=i+1)<t&&"/"!==e[s];)i=s;break;case"?":case"#":i=t;break;case"/":if("."===e[i+1])switch(l=e[1+ ++i],l){case"/":n+=e.substring(a,i-1),a=i+1;break;case void 0:case"?":case"#":return n+e.substring(a,i)+e.substr(i+1);case".":if(l=e[1+ ++i],void 0===l||"/"===l||"?"===l||"#"===l){if(n+=e.substring(a,i-2),(a=n.lastIndexOf("/"))>=s&&(n=n.substr(0,a)),"/"!==l)return`${n}/${e.substr(i+1)}`;a=i+1}}}l=e[++i]}return n+e.substring(a)}parse(e,t,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Je++}_`,this._prefixCallback=n||Ae,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const i=[];let s;if(this._callback=(a,l)=>{a?s=a:l&&i.push(l)},this._lexer.tokenize(e).every(a=>this._readCallback=this._readCallback(a)),s)throw s;return i}this._callback=t,this._lexer.tokenize(e,(i,s)=>{null!==i?(this._callback(i),this._callback=Ae):this._readCallback&&(this._readCallback=this._readCallback(s))})}}function Ae(){}function Ye(r,e){const t=e.namedNode;r._namedNode=t,r._blankNode=e.blankNode,r._literal=e.literal,r._variable=e.variable,r._quad=e.quad,r.DEFAULTGRAPH=e.defaultGraph(),r.RDF_FIRST=t(U.rdf.first),r.RDF_REST=t(U.rdf.rest),r.RDF_NIL=t(U.rdf.nil),r.N3_FORALL=t(U.r.forAll),r.N3_FORSOME=t(U.r.forSome),r.ABBREVIATIONS={a:t(U.rdf.type),"=":t(U.owl.sameAs),">":t(U.log.implies)},r.QUANTIFIERS_GRAPH=t("urn:n3:quantifiers")}Ye(je.prototype,St);let de=class{constructor(e){this.prefixPipe=e}parseTripleString(e){const t=new je,n=[];return new Promise((i,s)=>{t.parse(e,(a,l,c)=>{l?n.push(l):i({triples:n,namespaces:c}),a&&s(a)})})}limitTriples(e,t){return e?e.length>t?e.slice(0,t):e:[]}abbreviateTriples(e,t,n){return n||(n="text/turtle"),e.map(i=>{let s=i.subject.nominalValue,a=i.predicate.nominalValue,l=i.object.nominalValue;return"text/turtle"===n&&(null!=this._abbreviate(s,t)&&(s=this._abbreviate(s,t)),null!=this._abbreviate(a,t)&&(a=this._abbreviate(a,t)),null!=this._abbreviate(l,t)&&(l=this._abbreviate(l,t))),{subject:s,predicate:a,object:l}})}checkNamespacesInQuery(e,t){if(!e||!t)return;const n=this._extractNamespacesFromString(ue.TURTLE,t),i=this._extractNamespacesFromString(ue.SPARQL,e),s=this._extractQNamesFromSPARQLWhereClause(e),a=Object.keys(n),l=Object.keys(i);let c="";return a.forEach(o=>{-1===l.indexOf(o)&&(c+=`PREFIX ${o} ${n[o]}\n`)}),s.length>0&&s.forEach(o=>{if(-1===l.indexOf(o)){console.warn(`Prefix '${o}' not declared in SPARQL and/or Turtle header. Searching in default namespaces...`);const x=this.prefixPipe.transform(o,Q.LONG);if(x!==o){const _=`PREFIX ${o} <${x}>\n`;c+=_,console.warn(`Added '${_}' to SPARQL prefixes from list of default namespaces.`)}else console.warn(`'${o}' is unknown. Please provide a declaration.`)}}),""!==c&&(e=c+e),e}doQuery(e,t,n,i){return i||(i="text/turtle"),this._createStore().then(s=>(this._store=s,this._loadTriplesInStore(s,n,i))).then(s=>this._executeQuery(this._store,t)).then(s=>{if("select"===e){const a=s;return this._prepareSelectResponse(a).data}if("construct"===e){const a=s;return this._getNamespaces(n).then(l=>this.abbreviateTriples(a.triples,l,i))}})}getQuerytype(e){let t=[{queryType:"select",index:-1},{queryType:"construct",index:-1},{queryType:"ask",index:-1},{queryType:"count",index:-1},{queryType:"describe",index:-1},{queryType:"insert",index:-1},{queryType:"delete",index:-1}],n=!1,i=1/0;if(t=t.map(l=>(l.index=e.toLowerCase().indexOf(l.queryType),-1!==l.index&&(n=!0,l.index<i&&(i=l.index)),l)),!n)return null;let a=t.find(l=>l.index===i).queryType;return("insert"===a||"delete"===a)&&(a="update"),a}_abbreviate(e,t){let n=e;return-1!==e.indexOf("http")&&Object.entries(t).forEach(([i,s])=>{-1!==e.indexOf(s)&&(n=e.replace(s,i+":"))}),n}_createStore(){return new Promise((e,t)=>{rdfstore.create((n,i)=>{n&&t(n),e(i)})})}_executeQuery(e,t){return new Promise((n,i)=>{e.execute(t,(s,a)=>{s&&(console.error("_executeQuery# got ERROR",s),i(s)),n(a)})})}_extractNamespacesFromString(e,t){const n=t.toLowerCase().replace(/\s/g," ").split(" ").filter(l=>""!==l);let i;switch(e){case ue.TURTLE:i="@prefix".toLowerCase();break;case ue.SPARQL:i="PREFIX".toLowerCase();break;default:throw new Error(`The type must be TURTLE or SPARQL, but was: ${e}.`)}const s=n.reduce((l,c,o)=>(c===i&&l.push(o),l),[]),a={};return s.forEach(l=>{const c=n[l+1];let o=n[l+2];"."===o.at(-1)&&(o=o.slice(0,-1)),a[c]=o}),a}_extractQNamesFromSPARQLWhereClause(e){let t,n=e.toLowerCase(),i=0;const s=[],a=/\b[a-zA-Z]{2,15}:/g,l="WHERE {".toLowerCase();for(n.includes(l)&&(i=n.indexOf(l)+l.length),n=n.slice(i);null!==(t=a.exec(n));)t.index===a.lastIndex&&a.lastIndex++,t.forEach(c=>{-1===s.indexOf(c)&&s.push(c)});return s}_getNamespaces(e){const t=new je;return new Promise((n,i)=>{t.parse(e,(s,a,l)=>{a||n(l),s&&i(s)})})}_loadTriplesInStore(e,t,n){return n||(n="text/turtle"),new Promise((i,s)=>{e.load(n,t,(a,l)=>{a&&(console.error("_loadTriplesInStore# got error",a),s(a)),i(l)})})}_mapKeys(e,t){const n=Object.keys(e).map(i=>({[t[i]||i]:e[i]}));return Object.assign({},...n)}_prepareSelectResponse(e){if(!e)return{status:404,data:void 0};if(null==e[0])return{status:400,data:"Query returned no results"};const t=Object.keys(e[0]),n=e,i={token:"type",type:"datatype",lang:"xml:lang"};for(const a in n)if(n.hasOwnProperty(a))for(const l in t)if(t.hasOwnProperty(l)&&(n[a][t[l]]=this._mapKeys(n[a][t[l]],i),n[a][t[l]].label="",n[a][t[l]].value)){n[a][t[l]].label=this.prefixPipe.transform(n[a][t[l]].value,Q.SHORT);const c="http://www.w3.org/2001/XMLSchema#integer",o="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",x=n[a][t[l]].type,_=n[a][t[l]].datatype||"";"literal"===x&&(_===c||_===o)&&(n[a][t[l]].label=+n[a][t[l]].value)}return{status:200,data:{head:{vars:t},body:{bindings:n}}}}};de.ctorParameters=()=>[{type:ce}],de=(0,P.gn)([(0,m.GSi)()],de);var et=w(903),ze=w(711),tt=w(8840),nt=w(9374),W=w(1466);const Re=r=>()=>r;function Oe(r,{sourceEvent:e,subject:t,target:n,identifier:i,active:s,x:a,y:l,dx:c,dy:o,dispatch:x}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:o,enumerable:!0,configurable:!0},_:{value:x}})}function Dt(r){return!r.ctrlKey&&!r.button}function Lt(){return this.parentNode}function jt(r,e){return null==e?{x:r.x,y:r.y}:e}function At(){return navigator.maxTouchPoints||"ontouchstart"in this}Oe.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};var Ot=w(392);const rt=4294967296;function Qt(r){return r.x}function Bt(r){return r.y}var Vt=Math.PI*(3-Math.sqrt(5));function Ut(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),s=0,a=.6,l=new Map,c=(0,Ot.HT)(_),o=(0,et.Z)("tick","end"),x=function $t(){let r=1;return()=>(r=(1664525*r+1013904223)%rt)/rt}();function _(){d(),o.call("tick",e),t<n&&(c.stop(),o.call("end",e))}function d(f){var h,R,y=r.length;void 0===f&&(f=1);for(var q=0;q<f;++q)for(t+=(s-t)*i,l.forEach(function(u){u(t)}),h=0;h<y;++h)null==(R=r[h]).fx?R.x+=R.vx*=a:(R.x=R.fx,R.vx=0),null==R.fy?R.y+=R.vy*=a:(R.y=R.fy,R.vy=0);return e}function b(){for(var y,f=0,h=r.length;f<h;++f){if((y=r[f]).index=f,null!=y.fx&&(y.x=y.fx),null!=y.fy&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var R=10*Math.sqrt(.5+f),q=f*Vt;y.x=R*Math.cos(q),y.y=R*Math.sin(q)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(f){return f.initialize&&f.initialize(r,x),f}return null==r&&(r=[]),b(),e={tick:d,restart:function(){return c.restart(_),e},stop:function(){return c.stop(),e},nodes:function(f){return arguments.length?(r=f,b(),l.forEach(g),e):r},alpha:function(f){return arguments.length?(t=+f,e):t},alphaMin:function(f){return arguments.length?(n=+f,e):n},alphaDecay:function(f){return arguments.length?(i=+f,e):+i},alphaTarget:function(f){return arguments.length?(s=+f,e):s},velocityDecay:function(f){return arguments.length?(a=1-f,e):1-a},randomSource:function(f){return arguments.length?(x=f,l.forEach(g),e):x},force:function(f,h){return arguments.length>1?(null==h?l.delete(f):l.set(f,g(h)),e):l.get(f)},find:function(f,h,y){var u,C,I,k,F,R=0,q=r.length;for(null==y?y=1/0:y*=y,R=0;R<q;++R)(I=(u=f-(k=r[R]).x)*u+(C=h-k.y)*C)<y&&(F=k,y=I);return F},on:function(f,h){return arguments.length>1?(o.on(f,h),e):o.on(f)}}}function it(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,_,d,b,g,f,h,y,R,s=r._root,a={data:n},l=r._x0,c=r._y0,o=r._x1,x=r._y1;if(!s)return r._root=a,r;for(;s.length;)if((f=e>=(_=(l+o)/2))?l=_:o=_,(h=t>=(d=(c+x)/2))?c=d:x=d,i=s,!(s=s[y=h<<1|f]))return i[y]=a,r;if(b=+r._x.call(null,s.data),g=+r._y.call(null,s.data),e===b&&t===g)return a.next=s,i?i[y]=a:r._root=a,r;do{i=i?i[y]=new Array(4):r._root=new Array(4),(f=e>=(_=(l+o)/2))?l=_:o=_,(h=t>=(d=(c+x)/2))?c=d:x=d}while((y=h<<1|f)==(R=(g>=d)<<1|b>=_));return i[R]=s,i[y]=a,r}function O(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function ln(r){return r[0]}function un(r){return r[1]}function Ge(r,e,t){var n=new Me(null==e?ln:e,null==t?un:t,NaN,NaN,NaN,NaN);return null==r?n:n.addAll(r)}function Me(r,e,t,n,i,s){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=s,this._root=void 0}function st(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var G=Ge.prototype=Me.prototype;function re(r){return function(){return r}}function Y(r){return 1e-6*(r()-.5)}function fn(r){return r.x+r.vx}function pn(r){return r.y+r.vy}function _n(r){return r.index}function at(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}G.copy=function(){var t,n,r=new Me(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return r;if(!e.length)return r._root=st(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=st(n));return r},G.add=function Zt(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return it(this.cover(e,t),e,t,r)},G.addAll=function Wt(r){var e,t,i,s,n=r.length,a=new Array(n),l=new Array(n),c=1/0,o=1/0,x=-1/0,_=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(a[t]=i,l[t]=s,i<c&&(c=i),i>x&&(x=i),s<o&&(o=s),s>_&&(_=s));if(c>x||o>_)return this;for(this.cover(c,o).cover(x,_),t=0;t<n;++t)it(this,a[t],l[t],r[t]);return this},G.cover=function Kt(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,s=(n=Math.floor(e))+1;else{for(var c,o,a=i-t||1,l=this._root;t>r||r>=i||n>e||e>=s;)switch(o=(e<n)<<1|r<t,c=new Array(4),c[o]=l,l=c,a*=2,o){case 0:i=t+a,s=n+a;break;case 1:t=i-a,s=n+a;break;case 2:i=t+a,n=s-a;break;case 3:t=i-a,n=s-a}this._root&&this._root.length&&(this._root=l)}return this._x0=t,this._y0=n,this._x1=i,this._y1=s,this},G.data=function Xt(){var r=[];return this.visit(function(e){if(!e.length)do{r.push(e.data)}while(e=e.next)}),r},G.extent=function Jt(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function Yt(r,e,t){var n,a,l,c,o,g,f,i=this._x0,s=this._y0,x=this._x1,_=this._y1,d=[],b=this._root;for(b&&d.push(new O(b,i,s,x,_)),null==t?t=1/0:(i=r-t,s=e-t,x=r+t,_=e+t,t*=t);g=d.pop();)if(!(!(b=g.node)||(a=g.x0)>x||(l=g.y0)>_||(c=g.x1)<i||(o=g.y1)<s))if(b.length){var h=(a+c)/2,y=(l+o)/2;d.push(new O(b[3],h,y,c,o),new O(b[2],a,y,h,o),new O(b[1],h,l,c,y),new O(b[0],a,l,h,y)),(f=(e>=y)<<1|r>=h)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-f],d[d.length-1-f]=g)}else{var R=r-+this._x.call(null,b.data),q=e-+this._y.call(null,b.data),u=R*R+q*q;if(u<t){var C=Math.sqrt(t=u);i=r-C,s=e-C,x=r+C,_=e+C,n=b.data}}return n},G.remove=function en(r){if(isNaN(x=+this._x.call(null,r))||isNaN(_=+this._y.call(null,r)))return this;var e,n,i,s,x,_,d,b,g,f,h,y,t=this._root,a=this._x0,l=this._y0,c=this._x1,o=this._y1;if(!t)return this;if(t.length)for(;;){if((g=x>=(d=(a+c)/2))?a=d:c=d,(f=_>=(b=(l+o)/2))?l=b:o=b,e=t,!(t=t[h=f<<1|g]))return this;if(!t.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,y=h)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[h]=s:delete e[h],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=s,this)},G.removeAll=function tn(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this},G.root=function nn(){return this._root},G.size=function rn(){var r=0;return this.visit(function(e){if(!e.length)do{++r}while(e=e.next)}),r},G.visit=function sn(r){var t,i,s,a,l,c,e=[],n=this._root;for(n&&e.push(new O(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,s=t.x0,a=t.y0,l=t.x1,c=t.y1)&&n.length){var o=(s+l)/2,x=(a+c)/2;(i=n[3])&&e.push(new O(i,o,x,l,c)),(i=n[2])&&e.push(new O(i,s,x,o,c)),(i=n[1])&&e.push(new O(i,o,a,l,x)),(i=n[0])&&e.push(new O(i,s,a,o,x))}return this},G.visitAfter=function an(r){var n,e=[],t=[];for(this._root&&e.push(new O(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var s,a=n.x0,l=n.y0,c=n.x1,o=n.y1,x=(a+c)/2,_=(l+o)/2;(s=i[0])&&e.push(new O(s,a,l,x,_)),(s=i[1])&&e.push(new O(s,x,l,c,_)),(s=i[2])&&e.push(new O(s,a,_,x,o)),(s=i[3])&&e.push(new O(s,x,_,c,o))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this},G.x=function on(r){return arguments.length?(this._x=r,this):this._x},G.y=function cn(r){return arguments.length?(this._y=r,this):this._y};var mn=w(1280),$e=w(2232);var xn=w(4967);const Se_LINK_DISTANCE=10,Se_COLLISION_STRENGTH=1,Se_COLLISION_RADIUS=30,Se_CHARGE_STRENGTH=-10;let me=class{constructor(e,t){this.graphVisualizerService=e,this.prefixPipe=t,this.clickedNodeRequest=new m.vpe,this.faCompressArrowsAlt=z.udn,this.limitValues=[5,10,25,50,100,250,500,1e3],this.limit=50,this.sliderConfig=new N.w(1,.1,3,.01,1),this._resize$=new X.x,this._destroyed$=new X.x}onResize(){!this._graphContainer||!this.queryResultTriples||(this._divWidth=this._getContainerDimensions(this._graphContainer).width,this._divHeight=this._getContainerDimensions(this._graphContainer).height,this._resize$.next(!0))}ngOnInit(){this._resize$.pipe((0,oe.b)(150),(0,J.R)(this._destroyed$)).subscribe(e=>{this._redraw()}),this._redraw()}ngOnChanges(e){e.queryResultTriples&&e.queryResultTriples.currentValue&&!e.queryResultTriples.isFirstChange()&&(this.queryResultTriples=e.queryResultTriples.currentValue,this._redraw())}onLimitValueChange(e){this.limit=e,this._redraw()}onReCenter(){!this._svg||!this._divWidth||!this._divHeight||(this.onZoomChange(this.sliderConfig.initial),this._zoomBehaviour.translateTo(this._svg,this._divWidth/2,this._divHeight/2))}onZoomChange(e){this.sliderConfig.value=e,this._reScaleZoom()}log(e,t){const n=t&&JSON.parse(JSON.stringify(t));console.info(e,n)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_redraw(){this.queryResultTriples&&(this._cleanSVG(),this._createSVG(),this._attachData(),this._reScaleZoom())}_cleanSVG(){(function yn(r){return"string"==typeof r?new $e.Y1([document.querySelectorAll(r)],[document.documentElement]):new $e.Y1([(0,mn.Z)(r)],$e.Jz)})("svg.force-graph > *").remove()}_createSVG(){if(!this._graphContainer)return;let e,t;e=this._divWidth?this._divWidth:this._getContainerDimensions(this._graphContainer).width?this._getContainerDimensions(this._graphContainer).width:400,t=this._divHeight?this._divHeight:this._getContainerDimensions(this._graphContainer).height?this._getContainerDimensions(this._graphContainer).height:500,this._divWidth=e,this._divHeight=t-45,this._svg||(this._svg=ze.Z(this._graphContainer.nativeElement).append("svg").attr("class","force-graph")),this._svg.attr("width",this._divWidth).attr("height",this._divHeight),this._zoomGroup=this._svg.append("g").attr("class","zoom-container")}_attachData(){const e=this.graphVisualizerService.limitTriples(this.queryResultTriples,this.limit);"string"==typeof e?this.graphVisualizerService.parseTripleString(e).then(t=>{const n=this.graphVisualizerService.abbreviateTriples(t.triples,t.namespaces);this._simulationData=this._triplesToD3GraphData(n),this._setupForceSimulation(),this._updateSVG()}):(this._simulationData=this._triplesToD3GraphData(e),this._setupForceSimulation(),this._updateSVG())}_setupForceSimulation(){this._forceSimulation=Ut();const e=function hn(){var r,e,t,n,s,i=re(-30),a=1,l=1/0,c=.81;function o(b){var g,f=r.length,h=Ge(r,Qt,Bt).visitAfter(_);for(n=b,g=0;g<f;++g)e=r[g],h.visit(d)}function x(){if(r){var b,f,g=r.length;for(s=new Array(g),b=0;b<g;++b)f=r[b],s[f.index]=+i(f,b,r)}}function _(b){var f,h,R,q,u,g=0,y=0;if(b.length){for(R=q=u=0;u<4;++u)(f=b[u])&&(h=Math.abs(f.value))&&(g+=f.value,y+=h,R+=h*f.x,q+=h*f.y);b.x=R/y,b.y=q/y}else{(f=b).x=f.data.x,f.y=f.data.y;do{g+=s[f.data.index]}while(f=f.next)}b.value=g}function d(b,g,f,h){if(!b.value)return!0;var y=b.x-e.x,R=b.y-e.y,q=h-g,u=y*y+R*R;if(q*q/c<u)return u<l&&(0===y&&(u+=(y=Y(t))*y),0===R&&(u+=(R=Y(t))*R),u<a&&(u=Math.sqrt(a*u)),e.vx+=y*b.value*n/u,e.vy+=R*b.value*n/u),!0;if(!(b.length||u>=l)){(b.data!==e||b.next)&&(0===y&&(u+=(y=Y(t))*y),0===R&&(u+=(R=Y(t))*R),u<a&&(u=Math.sqrt(a*u)));do{b.data!==e&&(q=s[b.data.index]*n/u,e.vx+=y*q,e.vy+=R*q)}while(b=b.next)}}return o.initialize=function(b,g){r=b,t=g,x()},o.strength=function(b){return arguments.length?(i="function"==typeof b?b:re(+b),x(),o):i},o.distanceMin=function(b){return arguments.length?(a=b*b,o):Math.sqrt(a)},o.distanceMax=function(b){return arguments.length?(l=b*b,o):Math.sqrt(l)},o.theta=function(b){return arguments.length?(c=b*b,o):Math.sqrt(c)},o}().strength(s=>this._nodeRadius(s)*Se_CHARGE_STRENGTH),t=function dn(r,e){var t,n=1;function i(){var s,l,a=t.length,c=0,o=0;for(s=0;s<a;++s)c+=(l=t[s]).x,o+=l.y;for(c=(c/a-r)*n,o=(o/a-e)*n,s=0;s<a;++s)(l=t[s]).x-=c,l.y-=o}return null==r&&(r=0),null==e&&(e=0),i.initialize=function(s){t=s},i.x=function(s){return arguments.length?(r=+s,i):r},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(n=+s,i):n},i}(this._divWidth/2,this._divHeight/2),n=function gn(r){var e,t,n,i=1,s=1;function a(){for(var o,_,d,b,g,f,h,x=e.length,y=0;y<s;++y)for(_=Ge(e,fn,pn).visitAfter(l),o=0;o<x;++o)d=e[o],f=t[d.index],h=f*f,b=d.x+d.vx,g=d.y+d.vy,_.visit(R);function R(q,u,C,I,k){var F=q.data,j=q.r,D=f+j;if(!F)return u>b+D||I<b-D||C>g+D||k<g-D;if(F.index>d.index){var A=b-F.x-F.vx,V=g-F.y-F.vy,H=A*A+V*V;H<D*D&&(0===A&&(H+=(A=Y(n))*A),0===V&&(H+=(V=Y(n))*V),H=(D-(H=Math.sqrt(H)))/H*i,d.vx+=(A*=H)*(D=(j*=j)/(h+j)),d.vy+=(V*=H)*D,F.vx-=A*(D=1-D),F.vy-=V*D)}}}function l(o){if(o.data)return o.r=t[o.data.index];for(var x=o.r=0;x<4;++x)o[x]&&o[x].r>o.r&&(o.r=o[x].r)}function c(){if(e){var o,_,x=e.length;for(t=new Array(x),o=0;o<x;++o)_=e[o],t[_.index]=+r(_,o,e)}}return"function"!=typeof r&&(r=re(null==r?1:+r)),a.initialize=function(o,x){e=o,n=x,c()},a.iterations=function(o){return arguments.length?(s=+o,a):s},a.strength=function(o){return arguments.length?(i=+o,a):i},a.radius=function(o){return arguments.length?(r="function"==typeof o?o:re(+o),c(),a):r},a}().strength(Se_COLLISION_STRENGTH).radius(Se_COLLISION_RADIUS).iterations(2),i=function bn(r){var n,s,a,l,c,o,e=_n,t=function _(h){return 1/Math.min(l[h.source.index],l[h.target.index])},i=re(30),x=1;function d(h){for(var y=0,R=r.length;y<x;++y)for(var u,C,I,k,F,j,D,q=0;q<R;++q)C=(u=r[q]).source,k=(I=u.target).x+I.vx-C.x-C.vx||Y(o),F=I.y+I.vy-C.y-C.vy||Y(o),k*=j=((j=Math.sqrt(k*k+F*F))-s[q])/j*h*n[q],F*=j,I.vx-=k*(D=c[q]),I.vy-=F*D,C.vx+=k*(D=1-D),C.vy+=F*D}function b(){if(a){var h,u,y=a.length,R=r.length,q=new Map(a.map((C,I)=>[e(C,I,a),C]));for(h=0,l=new Array(y);h<R;++h)(u=r[h]).index=h,"object"!=typeof u.source&&(u.source=at(q,u.source)),"object"!=typeof u.target&&(u.target=at(q,u.target)),l[u.source.index]=(l[u.source.index]||0)+1,l[u.target.index]=(l[u.target.index]||0)+1;for(h=0,c=new Array(R);h<R;++h)u=r[h],c[h]=l[u.source.index]/(l[u.source.index]+l[u.target.index]);n=new Array(R),g(),s=new Array(R),f()}}function g(){if(a)for(var h=0,y=r.length;h<y;++h)n[h]=+t(r[h],h,r)}function f(){if(a)for(var h=0,y=r.length;h<y;++h)s[h]=+i(r[h],h,r)}return null==r&&(r=[]),d.initialize=function(h,y){a=h,o=y,b()},d.links=function(h){return arguments.length?(r=h,b(),d):r},d.id=function(h){return arguments.length?(e=h,d):e},d.iterations=function(h){return arguments.length?(x=+h,d):x},d.strength=function(h){return arguments.length?(t="function"==typeof h?h:re(+h),g(),d):t},d.distance=function(h){return arguments.length?(i="function"==typeof h?h:re(+h),f(),d):i},d}().links(this._simulationData.links).id(s=>s.predicate).distance(Se_LINK_DISTANCE);this._forceSimulation.force("charge_force",e).force("center_force",t).force("collide_force",n),this._forceSimulation.nodes(this._simulationData.nodes),this._forceSimulation.force("links",i),this._forceSimulation.alpha(1).restart()}_updateSVG(){if(!this._svg)return;this._zoomGroup.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",30).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:polyline").attr("points","0,-5 10,0 0,5");const e=this._zoomGroup.append("g").attr("class","links").selectAll(".link").data(this._simulationData.nodeTriples).enter().append("path").attr("marker-end","url(#end)").attr("class","link"),t=this._zoomGroup.append("g").attr("class","link-texts").selectAll(".link-text").data(this._simulationData.nodeTriples).enter().append("text").attr("class","link-text").text(s=>s.nodePredicate.label),n=this._zoomGroup.append("g").attr("class","node-texts").selectAll(".node-text").data(this._filterNodesByType(this._simulationData.nodes,M.node)).enter().append("text").attr("class","node-text").text(s=>s.label),i=this._zoomGroup.append("g").attr("class","nodes").selectAll(".node").data(this._filterNodesByType(this._simulationData.nodes,M.node)).enter().append("circle").attr("class",s=>s.owlClass?"class":-1!==s.label.indexOf("_:")?"blank":s.instance||-1!==s.label.indexOf("inst:")?"instance":"node").attr("id",s=>s.label).attr("r",s=>-1!==s.label.indexOf("_:")?8:s.instance||-1!==s.label.indexOf("inst:")?11:s.owlClass||-1!==s.label.indexOf("inst:")?10:9).on("click",(s,a)=>{this._clickedOnNode(s,a)});this._forceSimulation.on("tick",()=>{this._updateNodePositions(i),this._updateNodeTextPositions(n),this._updateLinkPositions(e),this._updateLinkTextPositions(t)}),this._dragHandler(i,this._forceSimulation),this._zoomHandler(this._zoomGroup,this._svg)}_reScaleZoom(){!this._svg||!this.sliderConfig.value||this._zoomBehaviour.scaleTo(this._svg,this.sliderConfig.value)}_checkForRdfType(e){return"a"===e.label||"rdf:type"===e.label||e.label===this.prefixPipe.transform("rdf:type",Q.LONG)}_clickedOnNode(e,t){e.defaultPrevented||this.clickedNodeRequest.emit(t)}_dragHandler(e,t){const a=function zt(){var l,c,o,x,r=Dt,e=Lt,t=jt,n=At,i={},s=(0,et.Z)("start","drag","end"),a=0,_=0;function d(u){u.on("mousedown.drag",b).filter(n).on("touchstart.drag",h).on("touchmove.drag",y,W.Q7).on("touchend.drag touchcancel.drag",R).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(u,C){if(!x&&r.call(this,u,C)){var I=q(this,e.call(this,u,C),u,C,"mouse");!I||((0,ze.Z)(u.view).on("mousemove.drag",g,W.Dd).on("mouseup.drag",f,W.Dd),(0,nt.Z)(u.view),(0,W.rG)(u),o=!1,l=u.clientX,c=u.clientY,I("start",u))}}function g(u){if((0,W.ZP)(u),!o){var C=u.clientX-l,I=u.clientY-c;o=C*C+I*I>_}i.mouse("drag",u)}function f(u){(0,ze.Z)(u.view).on("mousemove.drag mouseup.drag",null),(0,nt.D)(u.view,o),(0,W.ZP)(u),i.mouse("end",u)}function h(u,C){if(r.call(this,u,C)){var j,D,I=u.changedTouches,k=e.call(this,u,C),F=I.length;for(j=0;j<F;++j)(D=q(this,k,u,C,I[j].identifier,I[j]))&&((0,W.rG)(u),D("start",u,I[j]))}}function y(u){var k,F,C=u.changedTouches,I=C.length;for(k=0;k<I;++k)(F=i[C[k].identifier])&&((0,W.ZP)(u),F("drag",u,C[k]))}function R(u){var k,F,C=u.changedTouches,I=C.length;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),k=0;k<I;++k)(F=i[C[k].identifier])&&((0,W.rG)(u),F("end",u,C[k]))}function q(u,C,I,k,F,j){var V,H,ke,D=s.copy(),A=(0,tt.Z)(j||I,C);if(null!=(ke=t.call(u,new Oe("beforestart",{sourceEvent:I,target:d,identifier:F,active:a,x:A[0],y:A[1],dx:0,dy:0,dispatch:D}),k)))return V=ke.x-A[0]||0,H=ke.y-A[1]||0,function Vn(Ve,ct,Un){var Ue,ht=A;switch(Ve){case"start":i[F]=Vn,Ue=a++;break;case"end":delete i[F],--a;case"drag":A=(0,tt.Z)(Un||ct,C),Ue=a}D.call(Ve,u,new Oe(Ve,{sourceEvent:ct,subject:ke,target:d,identifier:F,active:Ue,x:A[0]+V,y:A[1]+H,dx:A[0]-ht[0],dy:A[1]-ht[1],dispatch:D}),k)}}return d.filter=function(u){return arguments.length?(r="function"==typeof u?u:Re(!!u),d):r},d.container=function(u){return arguments.length?(e="function"==typeof u?u:Re(u),d):e},d.subject=function(u){return arguments.length?(t="function"==typeof u?u:Re(u),d):t},d.touchable=function(u){return arguments.length?(n="function"==typeof u?u:Re(!!u),d):n},d.on=function(){var u=s.on.apply(s,arguments);return u===s?d:u},d.clickDistance=function(u){return arguments.length?(_=(u=+u)*u,d):Math.sqrt(_)},d}().on("start",(l,c)=>{l.sourceEvent.stopPropagation(),l.active||t.alphaTarget(.3).restart(),c.fx=c.x,c.fy=c.y}).on("drag",(l,c)=>{c.fx=l.x,c.fy=l.y}).on("end",(l,c)=>{l.active||t.alphaTarget(0),c.fx=null,c.fy=null});e.call(a)}_zoomHandler(e,t){this._zoomBehaviour=xn.sP().scaleExtent([this.sliderConfig.min,this.sliderConfig.max]).on("zoom",i=>{const s=i.transform,a=this._roundToNearestScaleStep(s.k);e.attr("transform",s),this._sliderInput.nativeElement.value=a,this._sliderInputLabel.nativeElement.innerText=a+"x",this.sliderConfig.value=a}),t.call(this._zoomBehaviour)}_filterNodesById(e,t){return e.filter(n=>n.id===t)[0]}_filterNodesByType(e,t){return e.filter(n=>n.type===t)}_getContainerDimensions(e){return e&&e.nativeElement?{width:e.nativeElement.clientWidth,height:e.nativeElement.clientHeight}:null}_nodeRadius(e){if(!e)return null;let t=8;return-1!==e.label.indexOf("_:")?t-=1:e.instance||-1!==e.label.indexOf("inst:")?t+=2:(e.owlClass||-1!==e.label.indexOf("inst:"))&&(t+=1),t}_roundToNearestScaleStep(e){const t=this.sliderConfig.stepSize;return((s,a)=>Number(Math.round(Number(s+"e"+a))+"e-"+a))(e,(s=t,Math.floor(s)===s?0:s.toString().split(".")[1].length||0));var s}_triplesToD3GraphData(e){if(!e)return;const t=new S;return e.forEach(n=>{const i=this.prefixPipe.transform(n.subject,Q.SHORT),s=this.prefixPipe.transform(n.predicate,Q.SHORT);let a=this.prefixPipe.transform(n.object,Q.SHORT);isNaN(a)||(a=Number(a)%1==0?String(Number(a)):String(Number(a).toFixed(2)));const l=new Ee(s,M.link);t.nodes.push(l);let c=this._filterNodesById(t.nodes,i);null==c&&(c=new Ee(i,M.node),t.nodes.push(c));let o=this._filterNodesById(t.nodes,a);null==o&&(o=new Ee(a,M.node),t.nodes.push(o)),!1===c.instance&&(c.instance=this._checkForRdfType(l)),!1===o.owlClass&&(o.owlClass=this._checkForRdfType(l)),t.links.push(new E(c,l)),t.links.push(new E(l,o)),t.nodeTriples.push(new dt(c,l,o))}),t}_updateNodePositions(e){e.attr("cx",t=>t.x).attr("cy",t=>t.y)}_updateNodeTextPositions(e){e.attr("x",t=>t.x+12).attr("y",t=>t.y+3)}_updateLinkPositions(e){e.attr("d",t=>{const n=t.nodeSubject.x,i=t.nodeSubject.y;let s=t.nodeObject.x,a=t.nodeObject.y;let c=0,o=0,x=0,_=0;return n===s&&i===a&&(x=-45,_=1,c=30,o=20,s+=1,a+=1),"M"+n+","+i+"A"+c+","+o+" "+x+","+_+",1 "+s+","+a})}_updateLinkTextPositions(e){e.attr("x",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?20+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3:10+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3).attr("y",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3-40:4+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3)}};me.ctorParameters=()=>[{type:de},{type:ce}],me.propDecorators={queryResultTriples:[{type:m.IIB}],height:[{type:m.IIB}],clickedNodeRequest:[{type:m.r_U}],_graphContainer:[{type:m.i9L,args:["graphContainer",{static:!0}]}],_sliderInput:[{type:m.i9L,args:["sliderInput",{static:!0}]}],_sliderInputLabel:[{type:m.i9L,args:["sliderInputLabel",{static:!0}]}],onResize:[{type:m.L6J,args:["window:resize"]}]},me=(0,P.gn)([(0,m.wA2)({selector:"awg-force-graph",template:ae,styles:[le]})],me);var vn=w(80),wn=w(1973);let Te=class{constructor(){this.clickedTableRequest=new m.vpe}isNotEmpty(e){if(e.head&&e.body)return e.head.vars.length>0&&e.body.bindings.length>0}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}};Te.propDecorators={queryResult$:[{type:m.IIB}],queryTime:[{type:m.IIB}],isFullscreen:[{type:m.IIB}],clickedTableRequest:[{type:m.r_U}]},Te=(0,P.gn)([(0,m.wA2)({selector:"awg-select-results",template:vn,changeDetection:m.n4l.OnPush,styles:[wn]})],Te);var Rn=w(6802),Sn=w(9495),fe=w(6139),B=w(2838);w(481);let Ce=class{constructor(){this.errorMessageRequest=new m.vpe,this.performQueryRequest=new m.vpe,this.resetQueryRequest=new m.vpe,this.updateQueryStringRequest=new m.vpe,this.cmSparqlConfig={lineNumbers:!0,firstLineNumber:1,lineWrapping:!0,matchBrackets:!0,mode:"sparql"},this.faDiagramProject=z.Bkj,this.faTable=z.B3e,this.selectedViewType=B.d.GRAPH,this.viewHandles=[new B.j("Graph view",B.d.GRAPH,z.Bkj),new B.j("Table view",B.d.TABLE,z.B3e)]}ngOnInit(){this.setViewType()}ngOnChanges(e){e.query&&!e.query.isFirstChange()&&this.setViewType()}setViewType(){this.query.queryType&&"construct"===this.query.queryType&&(this.selectedViewType=B.d.GRAPH),this.query.queryType&&"select"===this.query.queryType&&(this.selectedViewType=B.d.TABLE)}onViewChange(e){this.switchQueryType(e),this.onEditorInputChange(this.query.queryString),this.performQuery()}switchQueryType(e){switch(e){case B.d.TABLE:"construct"===this.query.queryType&&this.query.queryString.includes("CONSTRUCT")&&(this.query.queryString=this.query.queryString.replace("CONSTRUCT","SELECT *"),this.query.queryType="select");break;case B.d.GRAPH:"select"===this.query.queryType&&this.query.queryString.includes("SELECT")&&(this.query.queryString=this.query.queryString.replace(/SELECT.*\n/,"CONSTRUCT\n"),this.query.queryType="construct");break;case B.d.GRID:break;default:const t=e;throw new Error(`The view must be ${B.d.GRAPH} or ${B.d.TABLE}, but was: ${t}.`)}}isExampleQueriesEnabled(){return!!(this.query&&this.query.queryType&&this.query.queryLabel&&this.query.queryString&&this.queryList)}onEditorInputChange(e){this.updateQueryStringRequest.emit(e)}onQueryListChange(e){!e||!this.queryList||(e=this.queryList.find(t=>e.queryLabel===t.queryLabel&&e.queryType===t.queryType)||this.queryList[0],this.resetQuery(e))}performQuery(){this.query.queryString?this.performQueryRequest.emit():this.errorMessageRequest.emit(new fe.Kb("Empty query","Please enter a SPARQL query."))}resetQuery(e){!e||this.resetQueryRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-sparql-query":""}};Ce.propDecorators={sparqlAcc:[{type:m.i9L,args:["sparqlAcc"]}],queryList:[{type:m.IIB}],query:[{type:m.IIB}],isFullscreen:[{type:m.IIB}],errorMessageRequest:[{type:m.r_U}],performQueryRequest:[{type:m.r_U}],resetQueryRequest:[{type:m.r_U}],updateQueryStringRequest:[{type:m.r_U}]},Ce=(0,P.gn)([(0,m.wA2)({selector:"awg-sparql-editor",template:Rn,changeDetection:m.n4l.OnPush,styles:[Sn]})],Ce);var Tn=w(2519),Cn=w(388),Nn=w(67);let Ne=class{constructor(e){this.coreService=e}ngOnInit(){this.provideMetaData()}provideMetaData(){this.logos=this.coreService.getLogos()}};Ne.ctorParameters=()=>[{type:Nn.pX}],Ne=(0,P.gn)([(0,m.wA2)({selector:"awg-sparql-no-results",template:Tn,changeDetection:m.n4l.OnPush,styles:[Cn]})],Ne);var qn=w(4940),In=w(4775);let qe=class{constructor(){this.clickedTableRequest=new m.vpe}ngOnInit(){}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}};qe.propDecorators={queryResult:[{type:m.IIB}],queryTime:[{type:m.IIB}],clickedTableRequest:[{type:m.r_U}]},qe=(0,P.gn)([(0,m.wA2)({selector:"awg-sparql-table",template:qn,changeDetection:m.n4l.OnPush,styles:[In]})],qe);var Fn=w(8032),kn=w(5898);w(8779);let Ie=class{constructor(){this.errorMessageRequest=new m.vpe,this.performQueryRequest=new m.vpe,this.resetTriplesRequest=new m.vpe,this.updateTriplesRequest=new m.vpe,this.cmTriplesConfig={lineNumbers:!0,firstLineNumber:1,lineWrapping:!0,matchBrackets:!0,mode:"turtle"}}onEditorInputChange(e){this.updateTriplesRequest.emit(e)}performQuery(){this.triples?this.performQueryRequest.emit():this.errorMessageRequest.emit(new fe.Kb("Empty triples","Please enter triple content."))}resetTriples(){this.resetTriplesRequest.emit()}preventPanelCollapseOnFullscreen(e){this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-triples":""}};Ie.propDecorators={triplesAcc:[{type:m.i9L,args:["triplesAcc"]}],triples:[{type:m.IIB}],isFullscreen:[{type:m.IIB}],errorMessageRequest:[{type:m.r_U}],performQueryRequest:[{type:m.r_U}],resetTriplesRequest:[{type:m.r_U}],updateTriplesRequest:[{type:m.r_U}]},Ie=(0,P.gn)([(0,m.wA2)({selector:"awg-triples-editor",template:Fn,changeDetection:m.n4l.OnPush,styles:[kn]})],Ie);var En=w(5541),Pn=w(7045);let Fe=class{};Fe.propDecorators={queryType:[{type:m.IIB}]},Fe=(0,P.gn)([(0,m.wA2)({selector:"awg-unsupported-type-results",template:En,changeDetection:m.n4l.OnPush,styles:[Pn]})],Fe);var Dn=w(9671),Ln=w(2796),jn=w(1543),An=w(2076),lt=w(515);let ie=class{constructor(e,t){this.graphVisualizerService=e,this.toastService=t,this.defaultForceGraphHeight=500}ngOnInit(){this.resetTriples(),this.resetQuery()}resetTriples(){!this.graphRDFInputData.triples||(this.triples=this.graphRDFInputData.triples)}resetQuery(e){if(!this.graphRDFInputData.queryList)return;this.queryList=JSON.parse(JSON.stringify(this.graphRDFInputData.queryList));const t=e?this.queryList.find(n=>e.queryLabel===n.queryLabel&&e.queryType===n.queryType)||e:this.queryList[0];this.query=Object.assign({},t),this.performQuery()}performQuery(){if(this.query.queryString=this.graphVisualizerService.checkNamespacesInQuery(this.query.queryString,this.triples),this.query.queryType=this.graphVisualizerService.getQuerytype(this.query.queryString),"construct"===this.query.queryType||"select"===this.query.queryType){const e=this._queryLocalStore(this.query.queryType,this.query.queryString,this.triples);this.queryResult$=(0,An.D)(e)}else this.queryResult$=lt.E}onGraphNodeClick(e){!e||console.info("GraphVisualizerComponent# graphClick on node",e)}onTableNodeClick(e){!e||console.info("GraphVisualizerComponent# tableClick on URI",e)}showErrorMessage(e){if(!e||!e.message)return;const t=new fe.FN(e.message,{header:e.name,classname:"bg-danger text-light",delay:e.duration});this.toastService.add(t),console.error(e.name,":",e.message)}_queryLocalStore(e,t,n){var i=this;return(0,Dn.Z)(function*(){const s=Date.now();let a;try{a=yield i.graphVisualizerService.doQuery(e,t,n),i.queryTime=Date.now()-s}catch(l){console.error("#queryLocalstore got error:",l),l.message&&l.name&&(-1!==l.message.indexOf("undefined")&&i.showErrorMessage(new fe.Kb(l.name,"The query did not return any results.",5e3)),i.showErrorMessage(new fe.Kb(l.name,l.message,5e3))),i.queryTime=Date.now()-s,a=[]}return a})()}};ie.ctorParameters=()=>[{type:de},{type:fe.kl}],ie.propDecorators={fs:[{type:m.i9L,args:["fs"]}],graphRDFInputData:[{type:m.IIB}],isFullscreen:[{type:m.IIB}]},ie=(0,P.gn)([(0,m.wA2)({selector:"awg-graph-visualizer",template:Ln,changeDetection:m.n4l.Default,styles:[jn]})],ie);let Qe=class{};Qe=(0,P.gn)([(0,m.LVF)({imports:[se.m],declarations:[K,me,ie,ce,Te,Ce,Ne,qe,Ie,Fe],exports:[ie],providers:[de,ce]})],Qe);var ot=w(8755),zn=w(4263),On=w(9763),Gn=w(9808),Mn=w(3900),$n=w(262),Qn=w(5428),ut=w(3212);let pe=class{constructor(e,t,n){this.editionDataService=e,this.editionService=t,this.document=n,this.isFullscreen=!1,this.faExpand=z.TL5,this.faCompress=z.Qj4,this.GRAPH_IMAGES={OP12:"",OP25:Qn.w8.GRAPH_IMAGE_OP25.route},this.errorObject=null,this.ref=this}onKeydownHandler(e){!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(this.isFullscreen=!1)}ngOnInit(){this.getEditionGraphData()}getEditionGraphData(){this.editionGraphData$=this.editionService.getEditionWork().pipe((0,Mn.w)(e=>(this.editionWork=e,this.editionDataService.getEditionGraphData(this.editionWork))),(0,$n.K)(e=>(this.errorObject=e,lt.E)))}openFullscreen(){const e=this.child.fs.nativeElement;this.isFullscreen=!0,!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}closeFullscreen(){this.document.exitFullscreen?this.document.exitFullscreen():this.document.mozCancelFullScreen?this.document.mozCancelFullScreen():this.document.webkitExitFullscreen?this.document.webkitExitFullscreen():this.document.msExitFullscreen&&this.document.msExitFullscreen(),this.isFullscreen=!1}};pe.ctorParameters=()=>[{type:ut.Ko},{type:ut.OE},{type:void 0,decorators:[{type:m.tBr,args:[Gn.K0]}]}],pe.propDecorators={child:[{type:m.i9L,args:[ie]}],isFullscreen:[{type:m.pfw,args:["class.is-fullscreen"]}],onKeydownHandler:[{type:m.L6J,args:["document:fullscreenchange",["$event"]]}]},pe=(0,P.gn)([(0,m.wA2)({selector:"awg-edition-graph",template:zn,changeDetection:m.n4l.OnPush,styles:[On]})],pe);const Bn=[{path:"",component:pe,data:{title:"AWG Online Edition \u2013 Graph"}}],Hn=[pe];let Be=class{};Be=(0,P.gn)([(0,m.LVF)({imports:[ot.Bz.forChild(Bn)],exports:[ot.Bz]})],Be);let He=class{};He=(0,P.gn)([(0,m.LVF)({imports:[se.m,Qe,Be],declarations:[Hn]})],He)},481:(T,ee,w)=>{!function(P){"use strict";P.defineMode("sparql",function(m){var L,se=m.indentUnit;function te(p){return new RegExp("^(?:"+p.join("|")+")$","i")}var K=te(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),ae=te(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load","into"]),le=/[*+\-<>=&|\^\/!\?]/;function X(p,v){var S=p.next();if(L=null,"$"==S||"?"==S)return"?"==S&&p.match(/\s/,!1)?"operator":(p.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variable-2");if("<"==S&&!p.match(/^[\s\u00a0=]/,!1))return p.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==S||"'"==S)return v.tokenize=J(S),v.tokenize(p,v);if(/[{}\(\),\.;\[\]]/.test(S))return L=S,"bracket";if("#"==S)return p.skipToEnd(),"comment";if(le.test(S))return"operator";if(":"==S)return oe(p),"atom";if("@"==S)return p.eatWhile(/[a-z\d\-]/i),"meta";if(p.eatWhile(/[_\w\d]/),p.eat(":"))return oe(p),"atom";var E=p.current();return K.test(E)?"builtin":ae.test(E)?"keyword":"variable"}function oe(p){p.match(/(\.(?=[\w_\-\\%])|[:\w_-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-f\d][a-f\d])+/i)}function J(p){return function(v,S){for(var M,E=!1;null!=(M=v.next());){if(M==p&&!E){S.tokenize=X;break}E=!E&&"\\"==M}return"string"}}function z(p,v,S){p.context={prev:p.context,indent:p.indent,col:S,type:v}}function N(p){p.indent=p.context.indent,p.context=p.context.prev}return{startState:function(){return{tokenize:X,context:null,indent:0,col:0}},token:function(p,v){if(p.sol()&&(v.context&&null==v.context.align&&(v.context.align=!1),v.indent=p.indentation()),p.eatSpace())return null;var S=v.tokenize(p,v);if("comment"!=S&&v.context&&null==v.context.align&&"pattern"!=v.context.type&&(v.context.align=!0),"("==L)z(v,")",p.column());else if("["==L)z(v,"]",p.column());else if("{"==L)z(v,"}",p.column());else if(/[\]\}\)]/.test(L)){for(;v.context&&"pattern"==v.context.type;)N(v);v.context&&L==v.context.type&&(N(v),"}"==L&&v.context&&"pattern"==v.context.type&&N(v))}else"."==L&&v.context&&"pattern"==v.context.type?N(v):/atom|string|variable/.test(S)&&v.context&&(/[\}\]]/.test(v.context.type)?z(v,"pattern",p.column()):"pattern"==v.context.type&&!v.context.align&&(v.context.align=!0,v.context.col=p.column()));return S},indent:function(p,v){var S=v&&v.charAt(0),E=p.context;if(/[\]\}]/.test(S))for(;E&&"pattern"==E.type;)E=E.prev;var M=E&&S==E.type;return E?"pattern"==E.type?E.col:E.align?E.col+(M?0:1):E.indent+(M?0:se):0},lineComment:"#"}}),P.defineMIME("application/sparql-query","sparql")}(w(8266))},8779:(T,ee,w)=>{!function(P){"use strict";P.defineMode("turtle",function(m){var L,se=m.indentUnit;function te(N){return new RegExp("^(?:"+N.join("|")+")$","i")}te([]);var ae=te(["@prefix","@base","a"]),le=/[*+\-<>=&|]/;function X(N,p){var v=N.next();if(L=null,"<"==v&&!N.match(/^[\s\u00a0=]/,!1))return N.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==v||"'"==v)return p.tokenize=oe(v),p.tokenize(N,p);if(/[{}\(\),\.;\[\]]/.test(v))return L=v,null;if("#"==v)return N.skipToEnd(),"comment";if(le.test(v))return N.eatWhile(le),null;if(":"==v)return"operator";if(N.eatWhile(/[_\w\d]/),":"==N.peek())return"variable-3";var S=N.current();return ae.test(S)?"meta":v>="A"&&v<="Z"?"comment":"keyword"}function oe(N){return function(p,v){for(var E,S=!1;null!=(E=p.next());){if(E==N&&!S){v.tokenize=X;break}S=!S&&"\\"==E}return"string"}}function J(N,p,v){N.context={prev:N.context,indent:N.indent,col:v,type:p}}function z(N){N.indent=N.context.indent,N.context=N.context.prev}return{startState:function(){return{tokenize:X,context:null,indent:0,col:0}},token:function(N,p){if(N.sol()&&(p.context&&null==p.context.align&&(p.context.align=!1),p.indent=N.indentation()),N.eatSpace())return null;var v=p.tokenize(N,p);if("comment"!=v&&p.context&&null==p.context.align&&"pattern"!=p.context.type&&(p.context.align=!0),"("==L)J(p,")",N.column());else if("["==L)J(p,"]",N.column());else if("{"==L)J(p,"}",N.column());else if(/[\]\}\)]/.test(L)){for(;p.context&&"pattern"==p.context.type;)z(p);p.context&&L==p.context.type&&z(p)}else"."==L&&p.context&&"pattern"==p.context.type?z(p):/atom|string|variable/.test(v)&&p.context&&(/[\}\]]/.test(p.context.type)?J(p,"pattern",N.column()):"pattern"==p.context.type&&!p.context.align&&(p.context.align=!0,p.context.col=N.column()));return v},indent:function(N,p){var v=p&&p.charAt(0),S=N.context;if(/[\]\}]/.test(v))for(;S&&"pattern"==S.type;)S=S.prev;var E=S&&v==S.type;return S?"pattern"==S.type?S.col:S.align?S.col+(E?0:1):S.indent+(E?0:se):0},lineComment:"#"}}),P.defineMIME("text/turtle","turtle")}(w(8266))},352:T=>{let ee;T.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:global):w=>(ee||(ee=Promise.resolve())).then(w).catch(P=>setTimeout(()=>{throw P},0))},9763:T=>{"use strict";T.exports=""},1451:T=>{"use strict";T.exports=""},9020:T=>{"use strict";T.exports='#awg-force-graph-container {\n  position: relative;\n  width: 100%;\n}\n#awg-force-graph-container > .awg-force-graph-icon-bar {\n  position: relative;\n  width: 100%;\n}\n.awg-force-graph-panel-container {\n  position: inherit;\n  height: 100%;\n}\n/* slider */\n.input-group.awg-force-graph-zoom-slider-container {\n  flex-wrap: nowrap;\n  width: auto;\n}\n.input-group.awg-force-graph-zoom-slider-container > :not(:first-child) {\n  margin-left: 0px !important;\n}\n#slider-label.input-group-text {\n  min-width: 50px;\n  color: #149b9e;\n}\n/* slider input */\ninput[type=range].awg-force-graph-zoom-slider {\n  width: 100%;\n  background-color: transparent;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus {\n  outline: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-upper {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-webkit-slider-runnable-track {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-runnable-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 29px;\n  cursor: pointer;\n  -moz-margin-start: fill;\n  margin-right: fill;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-thumb {\n  width: 15px;\n  height: 27px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-track {\n  background: transparent;\n  border-color: transparent;\n  border-width: 7.4px 0;\n  color: transparent;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-upper {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  margin-top: 0px;\n  /*Needed to keep the Edge thumb centred*/\n}\n/* Simulation nodes */\n:host ::ng-deep .node {\n  stroke: #fff;\n  fill: #ddd;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .blank {\n  stroke: #fff;\n  fill: #000 !important;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .blank.instance {\n  stroke: #fff;\n  fill: #000;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .class {\n  stroke: #fff;\n  fill: #9e0000;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance {\n  stroke: #fff;\n  fill: lightseagreen;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance-space {\n  stroke: #fff;\n  fill: deepskyblue;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance-spaceType {\n  stroke: #fff;\n  fill: darkblue;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .link {\n  fill: none;\n  stroke: #999;\n  stroke-opacity: 0.6;\n  stroke-width: 1px;\n}\n:host ::ng-deep marker {\n  stroke: #999;\n  fill: rgba(124, 240, 10, 0);\n}\n:host ::ng-deep .node-text {\n  font: 15px "Roboto", sans-serif;\n  fill: black;\n}\n:host ::ng-deep .link-text {\n  font: 13px "Roboto", sans-serif;\n  fill: grey;\n}'},1543:T=>{"use strict";T.exports=":host::ng-deep .awg-fullscreen .collapse.show {\n  height: 100vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-triples.collapse.show {\n  height: 45vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-query.collapse.show {\n  height: 50vh;\n}"},1973:T=>{"use strict";T.exports=""},9495:T=>{"use strict";T.exports="ngx-codemirror ::ng-deep .CodeMirror {\n  font-size: initial;\n}"},388:T=>{"use strict";T.exports=""},4775:T=>{"use strict";T.exports="ngb-highlight ::ng-deep .ngb-highlight {\n  font-weight: 700;\n  background: yellow;\n}"},5898:T=>{"use strict";T.exports="ngx-codemirror ::ng-deep .CodeMirror {\n  font-size: initial;\n}"},7045:T=>{"use strict";T.exports=""},4263:T=>{"use strict";T.exports='\x3c!-- content: edition graph --\x3e\n<div>\n    \x3c!-- modal --\x3e\n    <awg-modal #modal></awg-modal>\n\n    \x3c!-- graph --\x3e\n    <div class="awg-graph-view p-5 border rounded-3" *ngIf="editionGraphData$ | async as editionGraphData; else error">\n        <div *ngFor="let graph of editionGraphData.graph">\n            \x3c!-- graph description --\x3e\n            <div class="awg-graph-description">\n                <p>\n                    So weit vorhanden, pr\xe4sentiert die vorliegende Ansicht Graph-Visualisierungen des ausgew\xe4hlten\n                    Editionsbereichs: Der <em>statische Graph</em> vermittelt dabei einen von den jeweiligen Editoren\n                    fixierten \xdcberblick editionsrelevanter Zusammenh\xe4nge und Abh\xe4ngigkeiten, der\n                    <em>dynamische Graph</em> bietet zus\xe4tzlich einen interaktiven Zugang zu dem zugrundeliegenden\n                    Datenbestand.\n                    <span class="text-danger"\n                        >Diese Funktionalit\xe4t ist noch nicht f\xfcr alle Skizzenbestandteile verf\xfcgbar, wird aber\n                        sukzessive erg\xe4nzt.</span\n                    >\n                </p>\n                <ng-container *ngIf="graph.description">\n                    <p\n                        *ngFor="let description of graph.description"\n                        [compile-html]="description"\n                        [compile-html-ref]="ref"></p>\n                </ng-container>\n            </div>\n\n            \x3c!-- dynamic graph --\x3e\n            <div class="awg-graph-dynamic" *ngIf="graph.rdfData && graph.rdfData.triples && graph.rdfData.queryList">\n                <h4>\n                    Dynamischer Graph\n                    <button\n                        type="button"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="modal.open(\'HINT_EDITION_GRAPH\')">\n                        Hinweise zur Nutzung\n                    </button>\n                    <button\n                        type="button"\n                        title="Open fullscreen"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="openFullscreen()"\n                        *ngIf="!isFullscreen">\n                        <fa-icon [icon]="faExpand"></fa-icon>\n                    </button>\n                    <button\n                        type="button"\n                        title="Close fullscreen"\n                        class="btn btn-sm btn-info ms-2"\n                        (click)="closeFullscreen()"\n                        *ngIf="isFullscreen">\n                        <fa-icon [icon]="faCompress"></fa-icon>\n                    </button>\n                </h4>\n                <p>\n                    Diese interaktive Visualisierung basiert auf Mads Holten\'s\n                    <a href="https://github.com/MadsHolten/sparql-visualizer">SPARQL Visualizer</a>. Sie modelliert den\n                    aktuellen Skizzenkomplex in Form eines <a href="https://www.w3.org/RDF/">RDF</a>-Graphen. Die\n                    zugrundeliegenden RDF-Daten sind unter dem Punkt <em>RDF Triples</em> einsehbar und lokal\n                    editierbar. Eine Filterung und Eingrenzung dieser RDF-Daten kann mithilfe der Abfragesprache\n                    <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a>\n                    unter dem Punkt <em>SPARQL Abfrage</em> vorgenommen werden; in der Voreinstellung werden hierbei\n                    alle vorhandenen Triples abgefragt.\n                </p>\n                <awg-graph-visualizer\n                    [graphRDFInputData]="graph.rdfData"\n                    [isFullscreen]="isFullscreen"></awg-graph-visualizer>\n            </div>\n\n            \x3c!-- static image --\x3e\n            <div class="awg-graph-static mt-3" *ngIf="graph.staticImage && graph.staticImage !== \'\'">\n                <h4>Statischer Graph</h4>\n                <div [compile-html]="graph.staticImage" [compile-html-ref]="ref"></div>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- error message --\x3e\n    <ng-template #error>\n        <div class="errorMessage" *ngIf="errorObject">\n            <div class="col-12 text-center">\n                <div class="alert alert-danger">{{ errorObject | json }}</div>\n            </div>\n        </div>\n    </ng-template>\n</div>\n'},3338:T=>{"use strict";T.exports='<ngb-accordion\n    #constructResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-construct-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-construct-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="queryResult.length > 0; else noResult">\n                    \x3c!-- Force graph visualization --\x3e\n                    <awg-force-graph\n                        class="full-width"\n                        [queryResultTriples]="queryResult"\n                        [height]="defaultForceGraphHeight"\n                        (clickedNodeRequest)="onGraphNodeClick($event)">\n                    </awg-force-graph>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},5534:T=>{"use strict";T.exports='<div\n    #graphContainer\n    id="awg-force-graph-container"\n    class="awg-force-graph-panel-container"\n    [ngStyle]="{ \'height.px\': height }">\n    <div class="awg-force-graph-icon-bar">\n        \x3c!-- Slider --\x3e\n        <div class="input-group input-group-sm awg-force-graph-zoom-slider-container float-start mb-3">\n            <span #sliderInputLabel class="input-group-text" id="slider-label">{{ sliderConfig.value }}x</span>\n            <input\n                type="range"\n                #sliderInput\n                class="awg-force-graph-zoom-slider"\n                id="awg-force-graph-zoom-slider"\n                name="zoomSlider"\n                aria-label="Zoom slider"\n                aria-describedby="slider-label"\n                [min]="sliderConfig.min"\n                [max]="sliderConfig.max"\n                [step]="sliderConfig.stepSize"\n                [(ngModel)]="sliderConfig.value"\n                (ngModelChange)="onZoomChange($event)" />\n            <button class="btn btn-sm btn-outline-info" type="submit" title="Reset" (click)="onReCenter()">\n                <fa-icon [icon]="faCompressArrowsAlt"></fa-icon>\n            </button>\n        </div>\n\n        \x3c!-- Limit --\x3e\n        <div class="btn-group awg-force-graph-node-limit-container float-end my-auto" *ngIf="queryResultTriples">\n            <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                <span *ngIf="limit < queryResultTriples.length">{{ limit }} von </span\n                >{{ queryResultTriples.length }} Triples\n            </button>\n            <div\n                class="btn-group"\n                ngbDropdown\n                container="body"\n                role="group"\n                aria-label="Button group with nested dropdown for node limit">\n                <button\n                    class="btn btn-sm btn-info dropdown-toggle-split"\n                    ngbDropdownToggle\n                    [disabled]="queryResultTriples.length === 0"></button>\n                <div class="dropdown-menu" ngbDropdownMenu>\n                    <ng-container *ngFor="let limitValue of limitValues">\n                        <button\n                            *ngIf="queryResultTriples.length > limitValue"\n                            class="dropdown-item"\n                            (click)="onLimitValueChange(limitValue)">\n                            <span>{{ limitValue }}</span>\n                        </button>\n                    </ng-container>\n                    <button class="dropdown-item" (click)="onLimitValueChange(queryResultTriples.length)">\n                        <span>Kein Limit</span>\n                    </button>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- <span *ngIf="message" class="message">{{message}}</span> --\x3e\n    </div>\n</div>\n'},2796:T=>{"use strict";T.exports='\x3c!-- Data: Triples, SPARQL query, result --\x3e\n<div #fs class="row awg-graph-visualizer" [class.is-fullscreen]="isFullscreen" *ngIf="graphRDFInputData">\n    <div [ngClass]="isFullscreen ? \'col-4 col-lg-3 px-0 awg-fullscreen\' : \'col-12\'">\n        <div [ngClass]="{ row: !isFullscreen }">\n            <div [ngClass]="{ \'col-6 pe-lg-0\': !isFullscreen }">\n                \x3c!-- awg-graph-triples-editor --\x3e\n                <awg-triples-editor\n                    [triples]="triples"\n                    [isFullscreen]="isFullscreen"\n                    (errorMessageRequest)="showErrorMessage($event)"\n                    (performQueryRequest)="performQuery()"\n                    (resetTriplesRequest)="resetTriples()"\n                    (updateTriplesRequest)="triples = $event"></awg-triples-editor>\n            </div>\n\n            <div [ngClass]="{ \'col-6 ps-lg-0\': !isFullscreen }">\n                \x3c!-- awg-graph-sparql-editor --\x3e\n                <awg-sparql-editor\n                    [queryList]="queryList"\n                    [query]="query"\n                    [isFullscreen]="isFullscreen"\n                    (errorMessageRequest)="showErrorMessage($event)"\n                    (performQueryRequest)="performQuery()"\n                    (resetQueryRequest)="resetQuery($event)"\n                    (updateQueryStringRequest)="query.queryString = $event"></awg-sparql-editor>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- Results --\x3e\n    <div [ngClass]="isFullscreen ? \'col-8 col-lg-9 px-0 awg-fullscreen\' : \'col-12\'">\n        \x3c!-- CONSTRUCT --\x3e\n        \x3c!-- awg-graph-construct-result --\x3e\n        <awg-construct-results\n            #queryConstructResultAcc\n            *ngIf="query.queryType === \'construct\'; else querySelectResultAcc"\n            [queryResult$]="queryResult$"\n            [defaultForceGraphHeight]="isFullscreen ? 1000 : defaultForceGraphHeight"\n            [isFullscreen]="isFullscreen"\n            (clickedNodeRequest)="onGraphNodeClick($event)"></awg-construct-results>\n\n        \x3c!-- SELECT --\x3e\n        \x3c!-- awg-graph-select-result --\x3e\n        <ng-template #querySelectResultAcc>\n            <awg-select-results\n                *ngIf="query.queryType === \'select\'; else queryUnsupportedTypeAcc"\n                [queryResult$]="queryResult$"\n                [queryTime]="queryTime"\n                [isFullscreen]="isFullscreen"\n                (clickedTableRequest)="onTableNodeClick($event)"></awg-select-results>\n        </ng-template>\n\n        \x3c!-- OTHERS --\x3e\n        \x3c!-- awg-graph-unsupported-query-type-result --\x3e\n        <ng-template #queryUnsupportedTypeAcc>\n            <awg-unsupported-type-results [queryType]="query.queryType"></awg-unsupported-type-results>\n        </ng-template>\n    </div>\n</div>\n\n<awg-toast aria-live="polite" aria-atomic="true"></awg-toast>\n'},80:T=>{"use strict";T.exports='<ngb-accordion\n    #selectResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-select-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-select-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="isNotEmpty(queryResult); else noResult">\n                    \x3c!-- SPARQL table visualization --\x3e\n                    <awg-sparql-table\n                        [queryResult]="queryResult"\n                        [queryTime]="queryTime"\n                        (clickedTableRequest)="onTableNodeClick($event)">\n                    </awg-sparql-table>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},6802:T=>{"use strict";T.exports='<ngb-accordion\n    #sparqlAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-sparql-query">\n        <ng-template ngbPanelHeader>\n            <div class="accordion-button awg-accordion-button-custom-header justify-content-between">\n                <button ngbPanelToggle class="p-0 btn btn-link text-start">SPARQL</button>\n\n                \x3c!-- View Handle --\x3e\n                <awg-view-handle-button-group\n                    [viewHandles]="viewHandles"\n                    [selectedViewType]="selectedViewType"\n                    (viewChangeRequest)="onViewChange($event)"></awg-view-handle-button-group>\n\n                \x3c!-- Example Query Handle --\x3e\n                <div\n                    class="p-0 btn-group awg-example-query-btn-group"\n                    *ngIf="isExampleQueriesEnabled()"\n                    style="padding: -3rem">\n                    <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                        Beispielabfragen\n                    </button>\n                    <div\n                        class="btn-group"\n                        ngbDropdown\n                        container="body"\n                        placement="bottom-right"\n                        role="group"\n                        aria-label="Button group with nested dropdown for sample queries">\n                        <button class="btn btn-sm btn-info" ngbDropdownToggle></button>\n                        <div ngbDropdownMenu>\n                            <h6 class="dropdown-header">Graph-Ansicht (CONSTRUCT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'construct\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                            <div class="dropdown-divider"></div>\n                            <h6 class="dropdown-header">Tabellen-Ansicht (SELECT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'select\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <ngx-codemirror\n                [(ngModel)]="query.queryString"\n                (ngModelChange)="onEditorInputChange($event)"\n                [options]="cmSparqlConfig">\n            </ngx-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="mt-2 awg-graph-visualizer-sparql-query-handle-buttons">\n                <button class="btn btn-outline-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-warning" (click)="resetQuery(query)">Reset</button>\n                <button class="btn btn-danger" (click)="onEditorInputChange(\'\')">Clear</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},2519:T=>{"use strict";T.exports='<div class="text-center">\n    <p>Entschuldigung, Ihre SPARQL-Anfrage f\xfchrte leider zu keinem Ergebnis.</p>\n    <p>M\xf6glicherweise k\xf6nnen Sie Ihre Anfrage anpassen.</p>\n    <p>\n        Ausf\xfchrliche Informationen zu SPARQL finden Sie unter:\n        <a href="{{ logos.sparql.href }}">{{ logos.sparql.href }}</a\n        >.\n    </p>\n    <p>\n        <a href="{{ logos.sparql.href }}">\n            <img width="33%" src="{{ logos.sparql.src }}" alt="{{ logos.sparql.alt }}" />\n        </a>\n    </p>\n</div>\n'},4940:T=>{"use strict";T.exports='<awg-table\n    *ngIf="queryResult"\n    [tableTitle]="\'SELECT Anfrage\'"\n    [headerInputData]="queryResult.head.vars"\n    [rowInputData]="queryResult.body.bindings"\n    (clickedTableValueRequest)="onTableNodeClick($event)"\n    (clickedTableRowRequest)="(undefined)"></awg-table>\n'},8032:T=>{"use strict";T.exports='<ngb-accordion\n    #triplesAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-triples" title="RDF Triples">\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <ngx-codemirror\n                [(ngModel)]="triples"\n                (ngModelChange)="onEditorInputChange($event)"\n                [options]="cmTriplesConfig">\n            </ngx-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="awg-graph-visualizer-triples-handle-buttons mt-2">\n                <button class="btn btn-outline-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-warning" (click)="resetTriples()">Reset</button>\n                <button class="btn btn-danger" (click)="onEditorInputChange(\'\')">Clear</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},5541:T=>{"use strict";T.exports='<ngb-accordion activeIds="awg-graph-visualizer-unsupported-query-type-result">\n    <ngb-panel id="awg-graph-visualizer-unsupported-query-type-result" title="Resultat">\n        <ng-template ngbPanelContent>\n            <p class="text-center">\n                Sorry, but the requested SPARQL query type {{ queryType | uppercase }} is not supported yet.\n            </p>\n            <p class="text-center">Please try a CONSTRUCT or SELECT query instead.</p>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'}}]);